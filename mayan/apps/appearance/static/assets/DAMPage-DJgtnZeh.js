var e=(e,t,l)=>new Promise((a,s)=>{var r=e=>{try{u(l.next(e))}catch(t){s(t)}},n=e=>{try{u(l.throw(e))}catch(t){s(t)}},u=e=>e.done?a(e.value):Promise.resolve(e.value).then(r,n);u((l=l.apply(e,t)).next())});import{b as t,C as l,s as a,e as s,f as r,i as n,A as u,t as o,l as i,T as d,j as c,r as v,c as p,w as m,m as x,M as g,G as f,F as k,h as b,v as h,p as y,N as w,k as _,a as C,u as z,O as M,x as j}from"./vue-vendor-B11yH1L4.js";import{u as $}from"./assetStore-A1gGqTWA.js";import{T as A,_ as V}from"./TagInput-DMflVXC-.js";import{e as O,d as B,h as S,f as I}from"./index-CEUju959.js";import{_ as U}from"./Modal.vue_vue_type_script_setup_true_lang-Cpe0tIsY.js";import{_ as T}from"./Pagination.vue_vue_type_script_setup_true_lang-DJgozKuc.js";import"./Badge.vue_vue_type_script_setup_true_lang-Bp_czRtF.js";import"./utils-vendor-BYNnTNyD.js";const D={key:0,class:"bulk-actions fixed bottom-0 left-0 right-0 bg-neutral-0 dark:bg-neutral-0 border-t border-neutral-300 dark:border-neutral-300 shadow-lg z-40",role:"toolbar","aria-label":"Массовые операции с активами"},L={class:"max-w-7xl mx-auto px-4 py-3"},P={class:"flex items-center justify-between"},F={class:"flex items-center gap-4"},H={class:"text-sm font-medium text-neutral-900 dark:text-neutral-900"},q={class:"font-bold"},E={class:"flex items-center gap-2"},G=B(t({__name:"BulkActions",props:{selectedCount:{}},emits:["tag","move","download","share","delete","clear-selection"],setup:e=>(t,v)=>(c(),l(d,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 translate-y-2","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-2"},{default:a(()=>[e.selectedCount>0?(c(),s("div",D,[n("div",L,[n("div",P,[n("div",F,[n("span",H,[v[6]||(v[6]=u(" Выбрано: ",-1)),n("span",q,o(e.selectedCount),1)]),n("button",{class:"text-sm text-neutral-600 dark:text-neutral-600 hover:text-neutral-900 dark:hover:text-neutral-900 transition-colors min-h-[44px] min-w-[120px] px-2",onClick:v[0]||(v[0]=e=>t.$emit("clear-selection")),type:"button","aria-label":"Снять выделение со всех активов"}," Снять выделение ")]),n("div",E,[i(O,{variant:"outline",size:"sm",onClick:v[1]||(v[1]=e=>t.$emit("tag")),"aria-label":"Добавить теги к выбранным активам"},{default:a(()=>[...v[7]||(v[7]=[n("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1),n("span",{class:"sr-only sm:not-sr-only"},"Теги",-1)])]),_:1}),i(O,{variant:"outline",size:"sm",onClick:v[2]||(v[2]=e=>t.$emit("move")),"aria-label":"Переместить выбранные активы"},{default:a(()=>[...v[8]||(v[8]=[n("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h18M7 15l1-1m8 0l1-1m-9 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),n("span",{class:"sr-only sm:not-sr-only"},"Переместить",-1)])]),_:1}),i(O,{variant:"outline",size:"sm",onClick:v[3]||(v[3]=e=>t.$emit("download")),"aria-label":"Скачать выбранные активы"},{default:a(()=>[...v[9]||(v[9]=[n("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),n("span",{class:"sr-only sm:not-sr-only"},"Скачать",-1)])]),_:1}),i(O,{variant:"outline",size:"sm",onClick:v[4]||(v[4]=e=>t.$emit("share")),"aria-label":"Поделиться выбранными активами"},{default:a(()=>[...v[10]||(v[10]=[n("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.552 3.546a2 2 0 002.938-2.187l.546-2.59A4.998 4.998 0 0017 12c0-.482-.114-.938-.316-1.342m0 2.684L12.448 8.454a2 2 0 00-2.938-2.187l-.546 2.59A4.998 4.998 0 007 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684"})],-1),n("span",{class:"sr-only sm:not-sr-only"},"Поделиться",-1)])]),_:1}),i(O,{variant:"danger",size:"sm",onClick:v[5]||(v[5]=e=>t.$emit("delete")),"aria-label":"Удалить выбранные активы"},{default:a(()=>[...v[11]||(v[11]=[n("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),n("span",{class:"sr-only sm:not-sr-only"},"Удалить",-1)])]),_:1})])])])])):r("",!0)]),_:1}))}),[["__scopeId","data-v-4453f20c"]]),N={class:"space-y-4"},J={class:"p-3 bg-neutral-50 dark:bg-neutral-50 rounded-md"},K={class:"text-sm text-neutral-600 dark:text-neutral-600"},R={key:0,class:"space-y-2"},W={class:"flex items-center justify-between text-sm"},Y={class:"text-neutral-900 dark:text-neutral-900 font-medium"},Z={class:"w-full bg-neutral-200 dark:bg-neutral-200 rounded-full h-2"},Q={key:1,class:"p-3 bg-error-50 dark:bg-error-50 rounded-md"},X={class:"text-sm text-error space-y-1"},ee={class:"flex justify-end gap-2"},te={key:0},le={key:1},ae=t({__name:"BulkTagModal",props:{isOpen:{type:Boolean},selectedIds:{},tagSuggestions:{default:()=>[]}},emits:["close","success"],setup(t,{emit:d}){const h=t,y=d,w=v("add"),_=v([]),C=v(!1),z=v(0),M=v([]),j=p(()=>h.selectedIds.length);function $(){return e(this,null,function*(){if(0!==_.value.length){C.value=!0,z.value=0,M.value=[];try{const e="add"===w.value?"add_tags":"remove"===w.value?"remove_tags":"add_tags",t="replace"===w.value?{tags:_.value,replace:!0}:{tags:_.value},l=yield S.bulkOperation({ids:h.selectedIds,action:e,data:t});l.success?(z.value=l.updated,l.errors&&l.errors.length>0&&(M.value=l.errors.map(e=>`Asset ${e.id}: ${e.error}`)),y("success",{updated:l.updated,failed:l.failed}),setTimeout(()=>{y("close")},1e3)):M.value=["Операция не удалась"]}catch(e){M.value=[I(e)]}finally{C.value=!1}}})}return m(()=>h.isOpen,e=>{e&&(w.value="add",_.value=[],C.value=!1,z.value=0,M.value=[])}),(e,d)=>(c(),l(U,{"is-open":t.isOpen,size:"md",onClose:d[3]||(d[3]=t=>e.$emit("close"))},{header:a(()=>[...d[4]||(d[4]=[n("h2",{class:"text-lg font-semibold text-neutral-900 dark:text-neutral-900"}," Массовое добавление тегов ",-1)])]),default:a(()=>[n("div",N,[n("div",null,[d[6]||(d[6]=n("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Операция ",-1)),x(n("select",{"onUpdate:modelValue":d[0]||(d[0]=e=>w.value=e),class:"w-full px-3 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md text-sm bg-neutral-0 dark:bg-neutral-0 text-neutral-900 dark:text-neutral-900 focus:outline-none focus:ring-2 focus:ring-primary-500"},[...d[5]||(d[5]=[n("option",{value:"add"},"Добавить теги",-1),n("option",{value:"remove"},"Удалить теги",-1),n("option",{value:"replace"},"Заменить все теги",-1)])],512),[[g,w.value]])]),n("div",null,[d[7]||(d[7]=n("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Теги ",-1)),i(A,{modelValue:_.value,"onUpdate:modelValue":d[1]||(d[1]=e=>_.value=e),suggestions:t.tagSuggestions,placeholder:"Введите теги...","allow-custom":!0},null,8,["modelValue","suggestions"])]),n("div",J,[n("p",K,[d[8]||(d[8]=u(" Операция будет применена к ",-1)),n("strong",null,o(j.value),1),d[9]||(d[9]=u(" выбранным активам. ",-1))])]),C.value?(c(),s("div",R,[n("div",W,[d[10]||(d[10]=n("span",{class:"text-neutral-600 dark:text-neutral-600"},"Обработка...",-1)),n("span",Y,o(z.value)+" / "+o(j.value),1)]),n("div",Z,[n("div",{class:"bg-primary-500 h-2 rounded-full transition-all duration-300",style:f({width:z.value/j.value*100+"%"})},null,4)])])):r("",!0),M.value.length>0?(c(),s("div",Q,[d[11]||(d[11]=n("p",{class:"text-sm font-medium text-error mb-2"},"Ошибки:",-1)),n("ul",X,[(c(!0),s(k,null,b(M.value,(e,t)=>(c(),s("li",{key:t},o(e),1))),128))])])):r("",!0)])]),footer:a(()=>[n("div",ee,[i(O,{variant:"outline",size:"md",onClick:d[2]||(d[2]=t=>e.$emit("close")),disabled:C.value},{default:a(()=>[...d[12]||(d[12]=[u(" Отмена ",-1)])]),_:1},8,["disabled"]),i(O,{variant:"primary",size:"md",onClick:$,disabled:0===_.value.length||C.value},{default:a(()=>[C.value?(c(),s("span",le,"Обработка...")):(c(),s("span",te,"Применить"))]),_:1},8,["disabled"])])]),_:1},8,["is-open"]))}}),se={class:"space-y-4"},re=["value"],ne={class:"p-3 bg-neutral-50 dark:bg-neutral-50 rounded-md"},ue={class:"text-sm text-neutral-600 dark:text-neutral-600"},oe={key:0,class:"space-y-2"},ie={class:"flex items-center justify-between text-sm"},de={class:"text-neutral-900 dark:text-neutral-900 font-medium"},ce={class:"w-full bg-neutral-200 dark:bg-neutral-200 rounded-full h-2"},ve={key:1,class:"p-3 bg-error-50 dark:bg-error-50 rounded-md"},pe={class:"text-sm text-error space-y-1"},me={class:"flex justify-end gap-2"},xe={key:0},ge={key:1},fe=t({__name:"BulkMoveModal",props:{isOpen:{type:Boolean},selectedIds:{},collections:{default:()=>[]}},emits:["close","success"],setup(t,{emit:d}){const w=t,_=d,C=v(""),z=v(!1),M=v(""),j=v(!1),$=v(0),A=v([]),V=p(()=>w.selectedIds.length);function B(){M.value.trim()&&(C.value=-1,z.value=!1)}function T(){return e(this,null,function*(){if(C.value){j.value=!0,$.value=0,A.value=[];try{const e=-1===C.value?M.value:C.value,t=yield S.bulkOperation({ids:w.selectedIds,action:"move",data:{collection_id:e}});t.success?($.value=t.updated,t.errors&&t.errors.length>0&&(A.value=t.errors.map(e=>`Asset ${e.id}: ${e.error}`)),_("success",{updated:t.updated,failed:t.failed}),setTimeout(()=>{_("close")},1e3)):A.value=["Операция не удалась"]}catch(e){A.value=[I(e)]}finally{j.value=!1}}})}return m(()=>w.isOpen,e=>{e&&(C.value="",z.value=!1,M.value="",j.value=!1,$.value=0,A.value=[])}),(e,d)=>(c(),l(U,{"is-open":t.isOpen,size:"md",onClose:d[4]||(d[4]=t=>e.$emit("close"))},{header:a(()=>[...d[5]||(d[5]=[n("h2",{class:"text-lg font-semibold text-neutral-900 dark:text-neutral-900"}," Переместить активы ",-1)])]),default:a(()=>[n("div",se,[n("div",null,[d[7]||(d[7]=n("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Коллекция назначения ",-1)),x(n("select",{"onUpdate:modelValue":d[0]||(d[0]=e=>C.value=e),class:"w-full px-3 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md text-sm bg-neutral-0 dark:bg-neutral-0 text-neutral-900 dark:text-neutral-900 focus:outline-none focus:ring-2 focus:ring-primary-500"},[d[6]||(d[6]=n("option",{value:""},"Выберите коллекцию...",-1)),(c(!0),s(k,null,b(t.collections,e=>(c(),s("option",{key:e.id,value:e.id},o(e.name),9,re))),128))],512),[[g,C.value]])]),n("div",null,[n("button",{class:"text-sm text-primary-500 hover:text-primary-600 transition-colors",onClick:d[1]||(d[1]=e=>z.value=!z.value)}," + Создать новую коллекцию "),z.value?x((c(),s("input",{key:0,"onUpdate:modelValue":d[2]||(d[2]=e=>M.value=e),type:"text",placeholder:"Название коллекции",class:"mt-2 w-full px-3 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md text-sm bg-neutral-0 dark:bg-neutral-0 text-neutral-900 dark:text-neutral-900 focus:outline-none focus:ring-2 focus:ring-primary-500",onKeydown:y(B,["enter"])},null,544)),[[h,M.value]]):r("",!0)]),n("div",ne,[n("p",ue,[n("strong",null,o(V.value),1),d[8]||(d[8]=u(" активов будет перемещено в выбранную коллекцию. ",-1))])]),j.value?(c(),s("div",oe,[n("div",ie,[d[9]||(d[9]=n("span",{class:"text-neutral-600 dark:text-neutral-600"},"Перемещение...",-1)),n("span",de,o($.value)+" / "+o(V.value),1)]),n("div",ce,[n("div",{class:"bg-primary-500 h-2 rounded-full transition-all duration-300",style:f({width:$.value/V.value*100+"%"})},null,4)])])):r("",!0),A.value.length>0?(c(),s("div",ve,[d[10]||(d[10]=n("p",{class:"text-sm font-medium text-error mb-2"},"Ошибки:",-1)),n("ul",pe,[(c(!0),s(k,null,b(A.value,(e,t)=>(c(),s("li",{key:t},o(e),1))),128))])])):r("",!0)])]),footer:a(()=>[n("div",me,[i(O,{variant:"outline",size:"md",onClick:d[3]||(d[3]=t=>e.$emit("close")),disabled:j.value},{default:a(()=>[...d[11]||(d[11]=[u(" Отмена ",-1)])]),_:1},8,["disabled"]),i(O,{variant:"primary",size:"md",onClick:T,disabled:!C.value||j.value},{default:a(()=>[j.value?(c(),s("span",ge,"Обработка...")):(c(),s("span",xe,"Переместить"))]),_:1},8,["disabled"])])]),_:1},8,["is-open"]))}}),ke={class:"space-y-4"},be={class:"p-4 bg-error-50 dark:bg-error-50 rounded-md border border-error-200 dark:border-error-200"},he={class:"flex items-start gap-3"},ye={class:"text-sm text-error"},we={class:"flex items-start gap-2"},_e={key:0,class:"space-y-2"},Ce={class:"flex items-center justify-between text-sm"},ze={class:"text-neutral-900 dark:text-neutral-900 font-medium"},Me={class:"w-full bg-neutral-200 dark:bg-neutral-200 rounded-full h-2"},je={key:1,class:"p-3 bg-error-50 dark:bg-error-50 rounded-md"},$e={class:"text-sm text-error space-y-1"},Ae={class:"flex justify-end gap-2"},Ve={key:0},Oe={key:1},Be=t({__name:"BulkDeleteModal",props:{isOpen:{type:Boolean},selectedIds:{}},emits:["close","success"],setup(t,{emit:d}){const g=t,h=d,y=v(!1),_=v(!1),C=v(0),z=v([]),M=p(()=>g.selectedIds.length);function j(){return e(this,null,function*(){if(y.value){_.value=!0,C.value=0,z.value=[];try{const e=yield S.bulkOperation({ids:g.selectedIds,action:"delete"});e.success?(C.value=e.updated,e.errors&&e.errors.length>0&&(z.value=e.errors.map(e=>`Asset ${e.id}: ${e.error}`)),h("success",{updated:e.updated,failed:e.failed}),setTimeout(()=>{h("close")},1e3)):z.value=["Операция не удалась"]}catch(e){z.value=[I(e)]}finally{_.value=!1}}})}return m(()=>g.isOpen,e=>{e&&(y.value=!1,_.value=!1,C.value=0,z.value=[])}),(e,d)=>(c(),l(U,{"is-open":t.isOpen,size:"md",onClose:d[2]||(d[2]=t=>e.$emit("close"))},{header:a(()=>[...d[3]||(d[3]=[n("h2",{class:"text-lg font-semibold text-neutral-900 dark:text-neutral-900"}," Удаление активов ",-1)])]),default:a(()=>[n("div",ke,[n("div",be,[n("div",he,[d[7]||(d[7]=n("svg",{class:"w-6 h-6 text-error flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),n("div",null,[d[6]||(d[6]=n("p",{class:"text-sm font-medium text-error mb-1"}," Внимание! Это действие нельзя отменить. ",-1)),n("p",ye,[d[4]||(d[4]=u(" Вы собираетесь удалить ",-1)),n("strong",null,o(M.value),1),d[5]||(d[5]=u(" активов. Это действие необратимо. ",-1))])])])]),n("div",we,[x(n("input",{id:"confirm-delete","onUpdate:modelValue":d[0]||(d[0]=e=>y.value=e),type:"checkbox",class:"mt-1 w-4 h-4 rounded border-neutral-300 text-error focus:ring-error"},null,512),[[w,y.value]]),d[8]||(d[8]=n("label",{for:"confirm-delete",class:"text-sm text-neutral-700 dark:text-neutral-700"}," Я понимаю, что это действие нельзя отменить ",-1))]),_.value?(c(),s("div",_e,[n("div",Ce,[d[9]||(d[9]=n("span",{class:"text-neutral-600 dark:text-neutral-600"},"Удаление...",-1)),n("span",ze,o(C.value)+" / "+o(M.value),1)]),n("div",Me,[n("div",{class:"bg-error h-2 rounded-full transition-all duration-300",style:f({width:C.value/M.value*100+"%"})},null,4)])])):r("",!0),z.value.length>0?(c(),s("div",je,[d[10]||(d[10]=n("p",{class:"text-sm font-medium text-error mb-2"},"Ошибки:",-1)),n("ul",$e,[(c(!0),s(k,null,b(z.value,(e,t)=>(c(),s("li",{key:t},o(e),1))),128))])])):r("",!0)])]),footer:a(()=>[n("div",Ae,[i(O,{variant:"outline",size:"md",onClick:d[1]||(d[1]=t=>e.$emit("close")),disabled:_.value},{default:a(()=>[...d[11]||(d[11]=[u(" Отмена ",-1)])]),_:1},8,["disabled"]),i(O,{variant:"danger",size:"md",onClick:j,disabled:!y.value||_.value},{default:a(()=>[_.value?(c(),s("span",Oe,"Удаление...")):(c(),s("span",Ve,"Удалить навсегда"))]),_:1},8,["disabled"])])]),_:1},8,["is-open"]))}}),Se={class:"space-y-4"},Ie={class:"space-y-2"},Ue={class:"flex items-center gap-2 cursor-pointer"},Te={class:"flex items-center gap-2 cursor-pointer"},De={class:"p-3 bg-neutral-50 dark:bg-neutral-50 rounded-md"},Le={class:"text-sm text-neutral-600 dark:text-neutral-600"},Pe={key:0,class:"space-y-2"},Fe={class:"flex items-center justify-between text-sm"},He={class:"text-neutral-600 dark:text-neutral-600"},qe={key:0,class:"text-neutral-900 dark:text-neutral-900 font-medium"},Ee={class:"w-full bg-neutral-200 dark:bg-neutral-200 rounded-full h-2"},Ge={key:1,class:"p-3 bg-primary-50 dark:bg-primary-50 rounded-md"},Ne={key:2,class:"p-3 bg-error-50 dark:bg-error-50 rounded-md"},Je={class:"text-sm font-medium text-error"},Ke={class:"flex justify-end gap-2"},Re={key:0},We={key:1},Ye=t({__name:"BulkDownloadModal",props:{isOpen:{type:Boolean},selectedIds:{}},emits:["close","success"],setup(t,{emit:d}){const k=t,b=d,h=v("zip"),y=v(!0),_=v(!1),C=v(!1),z=v(0),M=v(""),j=v(null),$=v(null),A=p(()=>k.selectedIds.length);function V(){return e(this,null,function*(){C.value=!0,z.value=0,M.value="Создание архива...",$.value=null;try{const e=yield S.bulkOperation({ids:k.selectedIds,action:"export",data:{format:h.value,include_metadata:y.value,preserve_structure:_.value}});e.success?(z.value=100,M.value="Архив создан!",j.value=`/api/v4/dam/assets/export/${e.updated}/download/`,b("success")):$.value="Не удалось создать архив"}catch(e){$.value=I(e)}finally{C.value=!1}})}function B(){j.value&&(window.open(j.value,"_blank"),b("close"))}return m(()=>k.isOpen,e=>{e&&(h.value="zip",y.value=!0,_.value=!1,C.value=!1,z.value=0,M.value="",j.value=null,$.value=null)}),(e,d)=>(c(),l(U,{"is-open":t.isOpen,size:"md",onClose:d[4]||(d[4]=t=>e.$emit("close"))},{header:a(()=>[...d[5]||(d[5]=[n("h2",{class:"text-lg font-semibold text-neutral-900 dark:text-neutral-900"}," Скачать активы ",-1)])]),default:a(()=>[n("div",Se,[n("div",null,[d[7]||(d[7]=n("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Формат архива ",-1)),x(n("select",{"onUpdate:modelValue":d[0]||(d[0]=e=>h.value=e),class:"w-full px-3 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md text-sm bg-neutral-0 dark:bg-neutral-0 text-neutral-900 dark:text-neutral-900 focus:outline-none focus:ring-2 focus:ring-primary-500"},[...d[6]||(d[6]=[n("option",{value:"zip"},"ZIP архив",-1),n("option",{value:"tar"},"TAR архив",-1)])],512),[[g,h.value]])]),n("div",Ie,[n("label",Ue,[x(n("input",{"onUpdate:modelValue":d[1]||(d[1]=e=>y.value=e),type:"checkbox",class:"w-4 h-4 rounded border-neutral-300 text-primary-500 focus:ring-primary-500"},null,512),[[w,y.value]]),d[8]||(d[8]=n("span",{class:"text-sm text-neutral-700 dark:text-neutral-700"}," Включить метаданные (JSON файл) ",-1))]),n("label",Te,[x(n("input",{"onUpdate:modelValue":d[2]||(d[2]=e=>_.value=e),type:"checkbox",class:"w-4 h-4 rounded border-neutral-300 text-primary-500 focus:ring-primary-500"},null,512),[[w,_.value]]),d[9]||(d[9]=n("span",{class:"text-sm text-neutral-700 dark:text-neutral-700"}," Сохранить структуру папок ",-1))])]),n("div",De,[n("p",Le,[d[10]||(d[10]=u(" Будет создан архив с ",-1)),n("strong",null,o(A.value),1),d[11]||(d[11]=u(" активами. ",-1))]),d[12]||(d[12]=n("p",{class:"text-xs text-neutral-500 dark:text-neutral-500 mt-1"}," После создания архива начнется автоматическая загрузка. ",-1))]),C.value?(c(),s("div",Pe,[n("div",Fe,[n("span",He,o(M.value),1),z.value>0?(c(),s("span",qe,o(z.value)+"% ",1)):r("",!0)]),n("div",Ee,[n("div",{class:"bg-primary-500 h-2 rounded-full transition-all duration-300",style:f({width:`${z.value}%`})},null,4)])])):r("",!0),j.value?(c(),s("div",Ge,[d[14]||(d[14]=n("p",{class:"text-sm text-neutral-900 dark:text-neutral-900 mb-2"}," Архив готов к скачиванию! ",-1)),i(O,{variant:"primary",size:"sm",onClick:B,class:"w-full"},{default:a(()=>[...d[13]||(d[13]=[n("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),u(" Скачать архив ",-1)])]),_:1})])):r("",!0),$.value?(c(),s("div",Ne,[n("p",Je,o($.value),1)])):r("",!0)])]),footer:a(()=>[n("div",Ke,[i(O,{variant:"outline",size:"md",onClick:d[3]||(d[3]=t=>e.$emit("close")),disabled:C.value&&!j.value},{default:a(()=>[u(o(j.value?"Закрыть":"Отмена"),1)]),_:1},8,["disabled"]),j.value?r("",!0):(c(),l(O,{key:0,variant:"primary",size:"md",onClick:V,disabled:C.value},{default:a(()=>[C.value?(c(),s("span",We,"Создание...")):(c(),s("span",Re,"Создать архив"))]),_:1},8,["disabled"]))])]),_:1},8,["is-open"]))}}),Ze={class:"space-y-4"},Qe={class:"space-y-2"},Xe={class:"flex items-center gap-2 cursor-pointer"},et={class:"flex items-center gap-2 cursor-pointer"},tt={class:"flex items-center gap-2 cursor-pointer"},lt={class:"flex items-center gap-2 cursor-pointer"},at=["min"],st={class:"flex items-center gap-2 cursor-pointer"},rt={key:0,class:"p-3 bg-primary-50 dark:bg-primary-50 rounded-md"},nt={class:"flex items-center gap-2"},ut=["value"],ot={class:"p-3 bg-neutral-50 dark:bg-neutral-50 rounded-md"},it={class:"text-sm text-neutral-600 dark:text-neutral-600"},dt={key:1,class:"p-3 bg-error-50 dark:bg-error-50 rounded-md"},ct={class:"text-sm font-medium text-error"},vt={class:"flex justify-end gap-2"},pt={key:0},mt={key:1},xt=t({__name:"BulkShareModal",props:{isOpen:{type:Boolean},selectedIds:{}},emits:["close","success"],setup(t,{emit:d}){const f=t,k=d,b=v("link"),y=v(["view"]),_=v(!1),C=v(""),z=v(!1),M=v(""),j=v(!1),$=v(null),A=v(null),V=p(()=>f.selectedIds.length),B=p(()=>{const e=new Date;return e.setDate(e.getDate()+1),e.toISOString().split("T")[0]});function T(){return e(this,null,function*(){if(0!==y.value.length){j.value=!0,A.value=null;try{if((yield S.bulkOperation({ids:f.selectedIds,action:"export",data:{share_type:b.value,permissions:y.value,expiration_date:_.value?C.value:null,password:z.value?M.value:null}})).success){const e=window.location.origin;$.value=`${e}/share/${Date.now()}`,k("success",$.value)}else A.value="Не удалось создать ссылку"}catch(e){A.value=I(e)}finally{j.value=!1}}})}function D(){$.value&&(navigator.clipboard.writeText($.value),alert("Ссылка скопирована в буфер обмена"))}return m(()=>f.isOpen,e=>{e&&(b.value="link",y.value=["view"],_.value=!1,C.value="",z.value=!1,M.value="",j.value=!1,$.value=null,A.value=null)}),(e,d)=>(c(),l(U,{"is-open":t.isOpen,size:"md",onClose:d[9]||(d[9]=t=>e.$emit("close"))},{header:a(()=>[...d[10]||(d[10]=[n("h2",{class:"text-lg font-semibold text-neutral-900 dark:text-neutral-900"}," Поделиться активами ",-1)])]),default:a(()=>[n("div",Ze,[n("div",null,[d[12]||(d[12]=n("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Тип доступа ",-1)),x(n("select",{"onUpdate:modelValue":d[0]||(d[0]=e=>b.value=e),class:"w-full px-3 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md text-sm bg-neutral-0 dark:bg-neutral-0 text-neutral-900 dark:text-neutral-900 focus:outline-none focus:ring-2 focus:ring-primary-500"},[...d[11]||(d[11]=[n("option",{value:"link"},"Публичная ссылка",-1),n("option",{value:"users"},"Конкретные пользователи",-1),n("option",{value:"team"},"Команда",-1)])],512),[[g,b.value]])]),n("div",null,[d[16]||(d[16]=n("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Права доступа ",-1)),n("div",Qe,[n("label",Xe,[x(n("input",{"onUpdate:modelValue":d[1]||(d[1]=e=>y.value=e),type:"checkbox",value:"view",class:"w-4 h-4 rounded border-neutral-300 text-primary-500 focus:ring-primary-500"},null,512),[[w,y.value]]),d[13]||(d[13]=n("span",{class:"text-sm text-neutral-700 dark:text-neutral-700"},"Просмотр",-1))]),n("label",et,[x(n("input",{"onUpdate:modelValue":d[2]||(d[2]=e=>y.value=e),type:"checkbox",value:"download",class:"w-4 h-4 rounded border-neutral-300 text-primary-500 focus:ring-primary-500"},null,512),[[w,y.value]]),d[14]||(d[14]=n("span",{class:"text-sm text-neutral-700 dark:text-neutral-700"},"Скачивание",-1))]),n("label",tt,[x(n("input",{"onUpdate:modelValue":d[3]||(d[3]=e=>y.value=e),type:"checkbox",value:"comment",class:"w-4 h-4 rounded border-neutral-300 text-primary-500 focus:ring-primary-500"},null,512),[[w,y.value]]),d[15]||(d[15]=n("span",{class:"text-sm text-neutral-700 dark:text-neutral-700"},"Комментирование",-1))])])]),n("div",null,[n("label",lt,[x(n("input",{"onUpdate:modelValue":d[4]||(d[4]=e=>_.value=e),type:"checkbox",class:"w-4 h-4 rounded border-neutral-300 text-primary-500 focus:ring-primary-500"},null,512),[[w,_.value]]),d[17]||(d[17]=n("span",{class:"text-sm text-neutral-700 dark:text-neutral-700"},"Ограничить срок действия",-1))]),_.value?x((c(),s("input",{key:0,"onUpdate:modelValue":d[5]||(d[5]=e=>C.value=e),type:"date",min:B.value,class:"mt-2 w-full px-3 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md text-sm bg-neutral-0 dark:bg-neutral-0 text-neutral-900 dark:text-neutral-900 focus:outline-none focus:ring-2 focus:ring-primary-500"},null,8,at)),[[h,C.value]]):r("",!0)]),n("div",null,[n("label",st,[x(n("input",{"onUpdate:modelValue":d[6]||(d[6]=e=>z.value=e),type:"checkbox",class:"w-4 h-4 rounded border-neutral-300 text-primary-500 focus:ring-primary-500"},null,512),[[w,z.value]]),d[18]||(d[18]=n("span",{class:"text-sm text-neutral-700 dark:text-neutral-700"},"Защитить паролем",-1))]),z.value?x((c(),s("input",{key:0,"onUpdate:modelValue":d[7]||(d[7]=e=>M.value=e),type:"password",placeholder:"Введите пароль",class:"mt-2 w-full px-3 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md text-sm bg-neutral-0 dark:bg-neutral-0 text-neutral-900 dark:text-neutral-900 focus:outline-none focus:ring-2 focus:ring-primary-500"},null,512)),[[h,M.value]]):r("",!0)]),$.value?(c(),s("div",rt,[d[20]||(d[20]=n("p",{class:"text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Ссылка создана: ",-1)),n("div",nt,[n("input",{value:$.value,type:"text",readonly:"",class:"flex-1 px-3 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md text-sm bg-neutral-0 dark:bg-neutral-0 text-neutral-900 dark:text-neutral-900"},null,8,ut),i(O,{variant:"outline",size:"sm",onClick:D},{default:a(()=>[...d[19]||(d[19]=[n("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})],-1)])]),_:1})])])):r("",!0),n("div",ot,[n("p",it,[n("strong",null,o(V.value),1),d[21]||(d[21]=u(" активов будет доступно по созданной ссылке. ",-1))])]),A.value?(c(),s("div",dt,[n("p",ct,o(A.value),1)])):r("",!0)])]),footer:a(()=>[n("div",vt,[i(O,{variant:"outline",size:"md",onClick:d[8]||(d[8]=t=>e.$emit("close")),disabled:j.value},{default:a(()=>[u(o($.value?"Закрыть":"Отмена"),1)]),_:1},8,["disabled"]),$.value?r("",!0):(c(),l(O,{key:0,variant:"primary",size:"md",onClick:T,disabled:0===y.value.length||j.value},{default:a(()=>[j.value?(c(),s("span",mt,"Создание...")):(c(),s("span",pt,"Создать ссылку"))]),_:1},8,["disabled"]))])]),_:1},8,["is-open"]))}}),gt={class:"gallery-view"},ft={key:0,class:"p-8"},kt={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},bt={key:1,class:"p-8 text-center"},ht={class:"max-w-md mx-auto"},yt={class:"mt-2 text-sm text-neutral-600 dark:text-neutral-600"},wt={key:2,class:"p-8 text-center"},_t={key:3,class:"gallery-content"},Ct={key:0,class:"flex items-center justify-between px-4 py-2 border-b border-neutral-300 dark:border-neutral-300 bg-neutral-0 dark:bg-neutral-0 sticky top-0 z-30"},zt={class:"flex items-center gap-4"},Mt={class:"flex items-center gap-2 cursor-pointer"},jt=["checked","indeterminate"],$t={class:"text-sm font-medium text-neutral-900 dark:text-neutral-900"},At={key:0,class:"text-sm text-neutral-600 dark:text-neutral-600"},Vt={key:1,class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 p-4",role:"grid","aria-label":"Галерея активов"},Ot={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4"},Bt=280,St=B(t({__name:"GalleryView",setup(e){const t=j(),a=$(),d=v(null),x=v(0),g=v(4),h=v(600),y=p(()=>{if(a.assets.length<100)return a.assets;const e=Math.ceil(h.value/Bt),t=Math.max(0,Math.floor(x.value/Bt)-2),l=Math.min(Math.ceil(a.assets.length/g.value),t+e+4),s=t*g.value,r=l*g.value;return a.assets.slice(Math.max(0,s),Math.min(a.assets.length,r))}),w=p(()=>{if(a.assets.length<100)return 0;return Math.ceil(a.assets.length/g.value)*Bt}),A=p(()=>{if(a.assets.length<100)return 0;return Math.max(0,Math.floor(x.value/Bt)-2)*Bt});let O=null;function B(e){const t=e.target;x.value=t.scrollTop,O&&cancelAnimationFrame(O),O=requestAnimationFrame(()=>{})}let S=null;function I(e){return a.selectedAssets.some(t=>t.id===e.id)}_(()=>{if(0===a.assets.length&&a.fetchAssets(),d.value){const e=()=>{if(d.value){const e=d.value.clientWidth;g.value=e>=1280?5:e>=1024?4:e>=768?3:e>=640?2:1,h.value=d.value.clientHeight||600}};e(),S=()=>{e(),O&&cancelAnimationFrame(O),O=requestAnimationFrame(e)},window.addEventListener("resize",S,{passive:!0})}}),C(()=>{d.value&&d.value.removeEventListener("scroll",B),S&&window.removeEventListener("resize",S),O&&cancelAnimationFrame(O)}),m(()=>a.currentPage,()=>{a.fetchAssets()});const U=p(()=>a.assets.length>0&&a.selectedAssets.length===a.assets.length),D=p(()=>a.selectedAssets.length>0&&a.selectedAssets.length<a.assets.length);function L(){U.value?a.clearSelection():a.selectAll()}function P(e){a.selectAsset(e,!0)}function F(e){t.push(`/dam/assets/${e.id}`)}function H(e){}function q(e){}function E(e){}function N(e){a.setPage(e)}function J(){a.fetchAssets()}const K=v(!1),R=v(!1),W=v(!1),Y=v(!1),Z=v(!1),Q=p(()=>a.selectedAssets.map(e=>e.id));function X(){K.value=!0}function ee(){R.value=!0}function te(){W.value=!0}function le(){Y.value=!0}function se(){Z.value=!0}function re(){a.clearSelection()}function ne(){a.fetchAssets(),a.clearSelection()}return(e,t)=>(c(),s("div",gt,[z(a).isLoading&&0===z(a).assets.length?(c(),s("div",ft,[n("div",kt,[(c(),s(k,null,b(8,e=>n("div",{key:e,class:"bg-neutral-100 dark:bg-neutral-100 rounded-lg animate-pulse",style:{height:"260px"}})),64))])])):z(a).error&&0===z(a).assets.length?(c(),s("div",bt,[n("div",ht,[t[5]||(t[5]=n("svg",{class:"mx-auto h-12 w-12 text-error",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t[6]||(t[6]=n("h3",{class:"mt-4 text-lg font-medium text-neutral-900 dark:text-neutral-900"}," Ошибка загрузки ",-1)),n("p",yt,o(z(a).error),1),n("button",{class:"mt-4 px-4 py-2 bg-primary-500 text-white rounded-md hover:bg-primary-600 transition-colors min-h-[44px] min-w-[120px]",onClick:J,type:"button","aria-label":"Повторить загрузку активов"}," Попробовать снова ")])])):0!==z(a).assets.length||z(a).isLoading?(c(),s("div",_t,[z(a).assets.length>0?(c(),s("div",Ct,[n("div",zt,[n("label",Mt,[n("input",{type:"checkbox",checked:U.value,indeterminate:D.value,class:"w-5 h-5 rounded border-neutral-300 text-primary-500 focus:ring-primary-500 min-w-[44px] min-h-[44px]",onChange:L,"aria-label":"Выбрать все активы"},null,40,jt),n("span",$t,o(U.value?"Снять выделение":"Выбрать все"),1)]),z(a).selectedCount>0?(c(),s("span",At,[t[8]||(t[8]=u(" Выбрано: ",-1)),n("strong",null,o(z(a).selectedCount),1),u(" из "+o(z(a).assets.length),1)])):r("",!0)])])):r("",!0),i(G,{"selected-count":z(a).selectedCount,onTag:X,onMove:ee,onDownload:le,onShare:se,onDelete:te,onClearSelection:re},null,8,["selected-count"]),z(a).assets.length<100?(c(),s("div",Vt,[(c(!0),s(k,null,b(z(a).assets,e=>(c(),l(V,{key:e.id,asset:e,"is-selected":I(e),"show-checkbox":!0,onSelect:P,onOpen:F,onPreview:H,onDownload:q,onMore:E},null,8,["asset","is-selected"]))),128))])):(c(),s("div",{key:2,ref_key:"virtualScrollContainer",ref:d,class:"virtual-scroll-container p-4",style:{height:"calc(100vh - 200px)","overflow-y":"auto"},role:"grid","aria-label":"Галерея активов (виртуальная прокрутка)",tabindex:"0",onScroll:B},[n("div",{style:f({height:`${w.value}px`,position:"relative"})},[n("div",{style:f({transform:`translateY(${A.value}px)`})},[n("div",Ot,[(c(!0),s(k,null,b(y.value,e=>(c(),l(V,{key:e.id,asset:e,"is-selected":I(e),"show-checkbox":!0,onSelect:P,onOpen:F,onPreview:H,onDownload:q,onMore:E},null,8,["asset","is-selected"]))),128))])],4)],4)],544)),z(a).totalCount>0?(c(),l(T,{key:3,"current-page":z(a).currentPage,"total-items":z(a).totalCount,"page-size":z(a).pageSize,onPageChange:N,class:"mb-20"},null,8,["current-page","total-items","page-size"])):r("",!0)])):(c(),s("div",wt,[...t[7]||(t[7]=[M('<div class="max-w-md mx-auto" data-v-8c257215><svg class="mx-auto h-12 w-12 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-8c257215><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" data-v-8c257215></path></svg><h3 class="mt-4 text-lg font-medium text-neutral-900 dark:text-neutral-900" data-v-8c257215> Нет активов </h3><p class="mt-2 text-sm text-neutral-600 dark:text-neutral-600" data-v-8c257215> Загрузите первый актив, чтобы начать работу </p></div>',1)])])),i(ae,{"is-open":K.value,"selected-ids":Q.value,onClose:t[0]||(t[0]=e=>K.value=!1),onSuccess:ne},null,8,["is-open","selected-ids"]),i(fe,{"is-open":R.value,"selected-ids":Q.value,onClose:t[1]||(t[1]=e=>R.value=!1),onSuccess:ne},null,8,["is-open","selected-ids"]),i(Be,{"is-open":W.value,"selected-ids":Q.value,onClose:t[2]||(t[2]=e=>W.value=!1),onSuccess:ne},null,8,["is-open","selected-ids"]),i(Ye,{"is-open":Y.value,"selected-ids":Q.value,onClose:t[3]||(t[3]=e=>Y.value=!1),onSuccess:ne},null,8,["is-open","selected-ids"]),i(xt,{"is-open":Z.value,"selected-ids":Q.value,onClose:t[4]||(t[4]=e=>Z.value=!1),onSuccess:ne},null,8,["is-open","selected-ids"])]))}}),[["__scopeId","data-v-8c257215"]]),It={class:"dam-page"},Ut=B(t({__name:"DAMPage",setup:e=>(e,t)=>(c(),s("div",It,[i(St)]))}),[["__scopeId","data-v-95a49611"]]);export{Ut as default};
//# sourceMappingURL=DAMPage-DJgtnZeh.js.map
