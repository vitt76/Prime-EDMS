{"version":3,"file":"adminStore-DpbUuV6G.js","sources":["../../src/services/adminService.ts","../../src/stores/adminStore.ts"],"sourcesContent":["import { apiService } from './apiService'\r\nimport type {\r\n  User,\r\n  CreateUserRequest,\r\n  UpdateUserRequest,\r\n  GetUsersParams,\r\n  BulkUserOperationRequest,\r\n  BulkUserOperationResponse,\r\n  MetadataSchema,\r\n  CreateMetadataSchemaRequest,\r\n  UpdateMetadataSchemaRequest,\r\n  GetSchemasParams,\r\n  Workflow,\r\n  CreateWorkflowRequest,\r\n  UpdateWorkflowRequest,\r\n  GetWorkflowsParams,\r\n  PaginatedResponse\r\n} from '@/types/admin'\r\n\r\n/**\r\n * Admin Service\r\n * \r\n * Service class for admin-related API operations.\r\n * Handles user management, metadata schemas, and workflows.\r\n */\r\nclass AdminService {\r\n  /**\r\n   * Get paginated list of users\r\n   */\r\n  async getUsers(params?: GetUsersParams): Promise<PaginatedResponse<User>> {\r\n    const queryParams: Record<string, string | number> = {}\r\n\r\n    if (params?.page) {\r\n      queryParams.page = params.page\r\n    }\r\n    if (params?.page_size) {\r\n      queryParams.page_size = params.page_size\r\n    }\r\n    if (params?.role) {\r\n      queryParams.role = params.role\r\n    }\r\n    if (params?.status) {\r\n      queryParams.status = params.status\r\n    }\r\n    if (params?.search) {\r\n      queryParams.search = params.search\r\n    }\r\n\r\n    return apiService.get<PaginatedResponse<User>>(\r\n      '/v4/admin/users/',\r\n      { params: queryParams },\r\n      false // Don't cache user lists for security\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Get single user by ID\r\n   */\r\n  async getUser(id: number): Promise<User> {\r\n    return apiService.get<User>(`/v4/admin/users/${id}/`, undefined, true)\r\n  }\r\n\r\n  /**\r\n   * Create new user\r\n   */\r\n  async createUser(data: CreateUserRequest): Promise<User> {\r\n    return apiService.post<User>('/v4/admin/users/', data)\r\n  }\r\n\r\n  /**\r\n   * Update user\r\n   */\r\n  async updateUser(id: number, data: UpdateUserRequest): Promise<User> {\r\n    return apiService.put<User>(`/v4/admin/users/${id}/`, data)\r\n  }\r\n\r\n  /**\r\n   * Delete user\r\n   */\r\n  async deleteUser(id: number): Promise<void> {\r\n    return apiService.delete<void>(`/v4/admin/users/${id}/`)\r\n  }\r\n\r\n  /**\r\n   * Bulk user operation\r\n   * \r\n   * Maximum 100 users per operation (validated on backend)\r\n   */\r\n  async bulkUserOperation(\r\n    operation: BulkUserOperationRequest\r\n  ): Promise<BulkUserOperationResponse> {\r\n    return apiService.post<BulkUserOperationResponse>(\r\n      '/v4/admin/users/bulk/',\r\n      operation\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Get paginated list of metadata schemas\r\n   */\r\n  async getSchemas(\r\n    params?: GetSchemasParams\r\n  ): Promise<PaginatedResponse<MetadataSchema>> {\r\n    const queryParams: Record<string, string | number | boolean> = {}\r\n\r\n    if (params?.page) {\r\n      queryParams.page = params.page\r\n    }\r\n    if (params?.page_size) {\r\n      queryParams.page_size = params.page_size\r\n    }\r\n    if (params?.applies_to) {\r\n      queryParams.applies_to = params.applies_to\r\n    }\r\n    if (params?.is_active !== undefined) {\r\n      queryParams.is_active = params.is_active\r\n    }\r\n    if (params?.search) {\r\n      queryParams.search = params.search\r\n    }\r\n\r\n    return apiService.get<PaginatedResponse<MetadataSchema>>(\r\n      '/v4/admin/schemas/',\r\n      { params: queryParams },\r\n      true // Cache schemas for 5 minutes\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Get single metadata schema by ID\r\n   */\r\n  async getSchema(id: number): Promise<MetadataSchema> {\r\n    return apiService.get<MetadataSchema>(\r\n      `/v4/admin/schemas/${id}/`,\r\n      undefined,\r\n      true\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Create new metadata schema\r\n   */\r\n  async createSchema(\r\n    data: CreateMetadataSchemaRequest\r\n  ): Promise<MetadataSchema> {\r\n    return apiService.post<MetadataSchema>('/v4/admin/schemas/', data)\r\n  }\r\n\r\n  /**\r\n   * Update metadata schema\r\n   */\r\n  async updateSchema(\r\n    id: number,\r\n    data: UpdateMetadataSchemaRequest\r\n  ): Promise<MetadataSchema> {\r\n    return apiService.put<MetadataSchema>(`/v4/admin/schemas/${id}/`, data)\r\n  }\r\n\r\n  /**\r\n   * Delete metadata schema\r\n   */\r\n  async deleteSchema(id: number): Promise<void> {\r\n    return apiService.delete<void>(`/v4/admin/schemas/${id}/`)\r\n  }\r\n\r\n  /**\r\n   * Get paginated list of workflows\r\n   */\r\n  async getWorkflows(\r\n    params?: GetWorkflowsParams\r\n  ): Promise<PaginatedResponse<Workflow>> {\r\n    const queryParams: Record<string, string | number | boolean> = {}\r\n\r\n    if (params?.page) {\r\n      queryParams.page = params.page\r\n    }\r\n    if (params?.page_size) {\r\n      queryParams.page_size = params.page_size\r\n    }\r\n    if (params?.is_active !== undefined) {\r\n      queryParams.is_active = params.is_active\r\n    }\r\n    if (params?.search) {\r\n      queryParams.search = params.search\r\n    }\r\n\r\n    return apiService.get<PaginatedResponse<Workflow>>(\r\n      '/v4/admin/workflows/',\r\n      { params: queryParams },\r\n      true // Cache workflows for 5 minutes\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Get single workflow by ID\r\n   */\r\n  async getWorkflow(id: number): Promise<Workflow> {\r\n    return apiService.get<Workflow>(\r\n      `/v4/admin/workflows/${id}/`,\r\n      undefined,\r\n      true\r\n    )\r\n  }\r\n\r\n  /**\r\n   * Create new workflow\r\n   */\r\n  async createWorkflow(data: CreateWorkflowRequest): Promise<Workflow> {\r\n    return apiService.post<Workflow>('/v4/admin/workflows/', data)\r\n  }\r\n\r\n  /**\r\n   * Update workflow\r\n   */\r\n  async updateWorkflow(\r\n    id: number,\r\n    data: UpdateWorkflowRequest\r\n  ): Promise<Workflow> {\r\n    return apiService.put<Workflow>(`/v4/admin/workflows/${id}/`, data)\r\n  }\r\n\r\n  /**\r\n   * Delete workflow\r\n   */\r\n  async deleteWorkflow(id: number): Promise<void> {\r\n    return apiService.delete<void>(`/v4/admin/workflows/${id}/`)\r\n  }\r\n}\r\n\r\nexport const adminService = new AdminService()\r\n\r\n","import { defineStore } from 'pinia'\r\nimport { ref, computed } from 'vue'\r\nimport { adminService } from '@/services/adminService'\r\nimport { formatApiError } from '@/utils/errors'\r\nimport type {\r\n  User,\r\n  CreateUserRequest,\r\n  UpdateUserRequest,\r\n  GetUsersParams,\r\n  BulkUserOperationRequest,\r\n  BulkUserOperationResponse,\r\n  MetadataSchema,\r\n  CreateMetadataSchemaRequest,\r\n  UpdateMetadataSchemaRequest,\r\n  GetSchemasParams,\r\n  Workflow,\r\n  CreateWorkflowRequest,\r\n  UpdateWorkflowRequest,\r\n  GetWorkflowsParams,\r\n  WorkflowNode,\r\n  PaginatedResponse\r\n} from '@/types/admin'\r\nimport { useAuthStore } from './authStore'\r\n\r\nconst CACHE_TTL = 5 * 60 * 1000 // 5 minutes in milliseconds\r\nconst MAX_BULK_OPERATION_SIZE = 100\r\n\r\nexport const useAdminStore = defineStore(\r\n  'admin',\r\n  () => {\r\n    const authStore = useAuthStore()\r\n\r\n    // Users state\r\n    const users = ref<User[]>([])\r\n    const totalUsersCount = ref(0)\r\n    const selectedUsers = ref<number[]>([])\r\n    const usersFilters = ref<{\r\n      role: string\r\n      status: string\r\n      search: string\r\n    }>({\r\n      role: '',\r\n      status: '',\r\n      search: ''\r\n    })\r\n\r\n    // Metadata Schemas state\r\n    const schemas = ref<MetadataSchema[]>([])\r\n    const totalSchemasCount = ref(0)\r\n    const currentSchema = ref<MetadataSchema | null>(null)\r\n\r\n    // Workflows state\r\n    const workflows = ref<Workflow[]>([])\r\n    const totalWorkflowsCount = ref(0)\r\n    const currentWorkflow = ref<Workflow | null>(null)\r\n    const selectedNode = ref<WorkflowNode | null>(null)\r\n\r\n    // Global state\r\n    const isLoading = ref(false)\r\n    const error = ref<string | null>(null)\r\n    const lastFetchTime = ref<number | null>(null)\r\n\r\n    // Computed properties - Permissions\r\n    const canCreateUser = computed(() => {\r\n      return authStore.hasPermission.value('admin.user_create')\r\n    })\r\n\r\n    const canEditUser = computed(() => {\r\n      return authStore.hasPermission.value('admin.user_edit')\r\n    })\r\n\r\n    const canDeleteUser = computed(() => {\r\n      return authStore.hasPermission.value('admin.user_delete')\r\n    })\r\n\r\n    const canManageSchemas = computed(() => {\r\n      return authStore.hasPermission.value('admin.schema_manage')\r\n    })\r\n\r\n    const canManageWorkflows = computed(() => {\r\n      return authStore.hasPermission.value('admin.workflow_manage')\r\n    })\r\n\r\n    // Computed properties - Filtered data\r\n    const filteredUsers = computed(() => {\r\n      let result = users.value\r\n\r\n      if (usersFilters.value.role) {\r\n        result = result.filter((user) => user.role === usersFilters.value.role)\r\n      }\r\n\r\n      if (usersFilters.value.status) {\r\n        if (usersFilters.value.status === 'active') {\r\n          result = result.filter((user) => user.is_active)\r\n        } else if (usersFilters.value.status === 'inactive') {\r\n          result = result.filter((user) => !user.is_active)\r\n        }\r\n      }\r\n\r\n      if (usersFilters.value.search) {\r\n        const searchLower = usersFilters.value.search.toLowerCase()\r\n        result = result.filter(\r\n          (user) =>\r\n            user.username.toLowerCase().includes(searchLower) ||\r\n            user.email.toLowerCase().includes(searchLower) ||\r\n            user.first_name.toLowerCase().includes(searchLower) ||\r\n            user.last_name.toLowerCase().includes(searchLower)\r\n        )\r\n      }\r\n\r\n      return result\r\n    })\r\n\r\n    const selectedUsersCount = computed(() => selectedUsers.value.length)\r\n\r\n    const hasUnsavedChanges = computed(() => {\r\n      // Track if any form has unsaved changes\r\n      // This would be set by form components\r\n      return false // Placeholder - implement based on form state\r\n    })\r\n\r\n    // Actions - Users\r\n    async function fetchUsers(params?: GetUsersParams): Promise<void> {\r\n      // Check cache\r\n      const now = Date.now()\r\n      if (\r\n        lastFetchTime.value &&\r\n        now - lastFetchTime.value < CACHE_TTL &&\r\n        users.value.length > 0 &&\r\n        !params\r\n      ) {\r\n        return // Use cached data\r\n      }\r\n\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        const queryParams: GetUsersParams = {\r\n          ...usersFilters.value,\r\n          ...params\r\n        }\r\n\r\n        const response: PaginatedResponse<User> = await adminService.getUsers(queryParams)\r\n\r\n        users.value = response.results\r\n        totalUsersCount.value = response.count\r\n        lastFetchTime.value = now\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        users.value = []\r\n        totalUsersCount.value = 0\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    async function createUser(userData: CreateUserRequest): Promise<User> {\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        const newUser = await adminService.createUser(userData)\r\n        // Optimistic update\r\n        users.value.push(newUser)\r\n        totalUsersCount.value++\r\n        lastFetchTime.value = null // Invalidate cache\r\n        return newUser\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    async function updateUser(id: number, data: UpdateUserRequest): Promise<User> {\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        const updatedUser = await adminService.updateUser(id, data)\r\n        // Update in array\r\n        const index = users.value.findIndex((u) => u.id === id)\r\n        if (index !== -1) {\r\n          users.value[index] = updatedUser\r\n        }\r\n        lastFetchTime.value = null // Invalidate cache\r\n        return updatedUser\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    async function deleteUser(id: number): Promise<void> {\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        await adminService.deleteUser(id)\r\n        // Remove from array\r\n        users.value = users.value.filter((u) => u.id !== id)\r\n        totalUsersCount.value--\r\n        selectedUsers.value = selectedUsers.value.filter((uid) => uid !== id)\r\n        lastFetchTime.value = null // Invalidate cache\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    async function bulkUserOperation(\r\n      operation: BulkUserOperationRequest\r\n    ): Promise<BulkUserOperationResponse> {\r\n      // Validate max size\r\n      if (operation.ids.length > MAX_BULK_OPERATION_SIZE) {\r\n        throw new Error(\r\n          `Maximum ${MAX_BULK_OPERATION_SIZE} users allowed per bulk operation`\r\n        )\r\n      }\r\n\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        const response = await adminService.bulkUserOperation(operation)\r\n        // Refresh users list\r\n        await fetchUsers()\r\n        return response\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    function selectUsers(ids: number[]): void {\r\n      selectedUsers.value = ids\r\n    }\r\n\r\n    function clearUserSelection(): void {\r\n      selectedUsers.value = []\r\n    }\r\n\r\n    function setUsersFilters(filters: Partial<GetUsersParams>): void {\r\n      usersFilters.value = {\r\n        ...usersFilters.value,\r\n        ...filters\r\n      }\r\n    }\r\n\r\n    function clearUsersFilters(): void {\r\n      usersFilters.value = {\r\n        role: '',\r\n        status: '',\r\n        search: ''\r\n      }\r\n    }\r\n\r\n    // Actions - Metadata Schemas\r\n    async function fetchSchemas(params?: GetSchemasParams): Promise<void> {\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        const response: PaginatedResponse<MetadataSchema> =\r\n          await adminService.getSchemas(params)\r\n\r\n        schemas.value = response.results\r\n        totalSchemasCount.value = response.count\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        schemas.value = []\r\n        totalSchemasCount.value = 0\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    async function getSchema(id: number): Promise<MetadataSchema> {\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        const schema = await adminService.getSchema(id)\r\n        currentSchema.value = schema\r\n        return schema\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        currentSchema.value = null\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    async function createSchema(\r\n      data: CreateMetadataSchemaRequest\r\n    ): Promise<MetadataSchema> {\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        const newSchema = await adminService.createSchema(data)\r\n        schemas.value.push(newSchema)\r\n        totalSchemasCount.value++\r\n        return newSchema\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    async function updateSchema(\r\n      id: number,\r\n      data: UpdateMetadataSchemaRequest\r\n    ): Promise<MetadataSchema> {\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        const updatedSchema = await adminService.updateSchema(id, data)\r\n        const index = schemas.value.findIndex((s) => s.id === id)\r\n        if (index !== -1) {\r\n          schemas.value[index] = updatedSchema\r\n        }\r\n        if (currentSchema.value?.id === id) {\r\n          currentSchema.value = updatedSchema\r\n        }\r\n        return updatedSchema\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    async function deleteSchema(id: number): Promise<void> {\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        await adminService.deleteSchema(id)\r\n        schemas.value = schemas.value.filter((s) => s.id !== id)\r\n        totalSchemasCount.value--\r\n        if (currentSchema.value?.id === id) {\r\n          currentSchema.value = null\r\n        }\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    function setCurrentSchema(schema: MetadataSchema | null): void {\r\n      currentSchema.value = schema\r\n    }\r\n\r\n    // Actions - Workflows\r\n    async function fetchWorkflows(params?: GetWorkflowsParams): Promise<void> {\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        const response: PaginatedResponse<Workflow> =\r\n          await adminService.getWorkflows(params)\r\n\r\n        workflows.value = response.results\r\n        totalWorkflowsCount.value = response.count\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        workflows.value = []\r\n        totalWorkflowsCount.value = 0\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    async function getWorkflow(id: number): Promise<Workflow> {\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        const workflow = await adminService.getWorkflow(id)\r\n        currentWorkflow.value = workflow\r\n        return workflow\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        currentWorkflow.value = null\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    async function createWorkflow(\r\n      data: CreateWorkflowRequest\r\n    ): Promise<Workflow> {\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        const newWorkflow = await adminService.createWorkflow(data)\r\n        workflows.value.push(newWorkflow)\r\n        totalWorkflowsCount.value++\r\n        return newWorkflow\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    async function updateWorkflow(\r\n      id: number,\r\n      data: UpdateWorkflowRequest\r\n    ): Promise<Workflow> {\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        const updatedWorkflow = await adminService.updateWorkflow(id, data)\r\n        const index = workflows.value.findIndex((w) => w.id === id)\r\n        if (index !== -1) {\r\n          workflows.value[index] = updatedWorkflow\r\n        }\r\n        if (currentWorkflow.value?.id === id) {\r\n          currentWorkflow.value = updatedWorkflow\r\n        }\r\n        return updatedWorkflow\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    async function deleteWorkflow(id: number): Promise<void> {\r\n      isLoading.value = true\r\n      error.value = null\r\n\r\n      try {\r\n        await adminService.deleteWorkflow(id)\r\n        workflows.value = workflows.value.filter((w) => w.id !== id)\r\n        totalWorkflowsCount.value--\r\n        if (currentWorkflow.value?.id === id) {\r\n          currentWorkflow.value = null\r\n        }\r\n      } catch (err) {\r\n        error.value = formatApiError(err)\r\n        throw err\r\n      } finally {\r\n        isLoading.value = false\r\n      }\r\n    }\r\n\r\n    function setCurrentWorkflow(workflow: Workflow | null): void {\r\n      currentWorkflow.value = workflow\r\n    }\r\n\r\n    function setSelectedNode(node: WorkflowNode | null): void {\r\n      selectedNode.value = node\r\n    }\r\n\r\n    // Utility actions\r\n    function clearError(): void {\r\n      error.value = null\r\n    }\r\n\r\n    function invalidateCache(): void {\r\n      lastFetchTime.value = null\r\n    }\r\n\r\n    return {\r\n      // State - Users\r\n      users,\r\n      totalUsersCount,\r\n      selectedUsers,\r\n      usersFilters,\r\n\r\n      // State - Schemas\r\n      schemas,\r\n      totalSchemasCount,\r\n      currentSchema,\r\n\r\n      // State - Workflows\r\n      workflows,\r\n      totalWorkflowsCount,\r\n      currentWorkflow,\r\n      selectedNode,\r\n\r\n      // Global state\r\n      isLoading,\r\n      error,\r\n      lastFetchTime,\r\n\r\n      // Computed - Permissions\r\n      canCreateUser,\r\n      canEditUser,\r\n      canDeleteUser,\r\n      canManageSchemas,\r\n      canManageWorkflows,\r\n\r\n      // Computed - Data\r\n      filteredUsers,\r\n      selectedUsersCount,\r\n      hasUnsavedChanges,\r\n\r\n      // Actions - Users\r\n      fetchUsers,\r\n      createUser,\r\n      updateUser,\r\n      deleteUser,\r\n      bulkUserOperation,\r\n      selectUsers,\r\n      clearUserSelection,\r\n      setUsersFilters,\r\n      clearUsersFilters,\r\n\r\n      // Actions - Schemas\r\n      fetchSchemas,\r\n      getSchema,\r\n      createSchema,\r\n      updateSchema,\r\n      deleteSchema,\r\n      setCurrentSchema,\r\n\r\n      // Actions - Workflows\r\n      fetchWorkflows,\r\n      getWorkflow,\r\n      createWorkflow,\r\n      updateWorkflow,\r\n      deleteWorkflow,\r\n      setCurrentWorkflow,\r\n      setSelectedNode,\r\n\r\n      // Utility actions\r\n      clearError,\r\n      invalidateCache\r\n    }\r\n  },\r\n  {\r\n    persist: {\r\n      paths: ['usersFilters'] // Only persist filters, not actual data\r\n    }\r\n  }\r\n)\r\n\r\n"],"names":["adminService","getUsers","params","__async","this","queryParams","page","page_size","role","status","search","apiService","get","getUser","id","createUser","data","post","updateUser","put","deleteUser","delete","bulkUserOperation","operation","getSchemas","applies_to","is_active","getSchema","createSchema","updateSchema","deleteSchema","getWorkflows","getWorkflow","createWorkflow","updateWorkflow","deleteWorkflow","useAdminStore","defineStore","authStore","useAuthStore","users","ref","totalUsersCount","selectedUsers","usersFilters","schemas","totalSchemasCount","currentSchema","workflows","totalWorkflowsCount","currentWorkflow","selectedNode","isLoading","error","lastFetchTime","canCreateUser","computed","hasPermission","value","canEditUser","canDeleteUser","canManageSchemas","canManageWorkflows","filteredUsers","result","filter","user","searchLower","toLowerCase","username","includes","email","first_name","last_name","selectedUsersCount","length","hasUnsavedChanges","fetchUsers","now","Date","__spreadValues","response","results","count","err","formatApiError","userData","newUser","push","updatedUser","index","findIndex","u","uid","ids","Error","selectUsers","clearUserSelection","setUsersFilters","filters","clearUsersFilters","fetchSchemas","schema","newSchema","updatedSchema","s","_a","setCurrentSchema","fetchWorkflows","workflow","newWorkflow","updatedWorkflow","w","setCurrentWorkflow","setSelectedNode","node","clearError","invalidateCache","persist","paths"],"mappings":"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"}