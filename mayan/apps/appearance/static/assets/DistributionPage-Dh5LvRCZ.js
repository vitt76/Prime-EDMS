var e=(e,t,l)=>new Promise((a,n)=>{var r=e=>{try{u(l.next(e))}catch(t){n(t)}},s=e=>{try{u(l.throw(e))}catch(t){n(t)}},u=e=>e.done?a(e.value):Promise.resolve(e.value).then(r,s);u((l=l.apply(e,t)).next())});import{b as t,c as l,e as a,j as n,l as r,s,i as u,f as i,t as o,A as d,u as c,F as v,h as p,C as m,r as x,k,m as b,v as h,N as f,n as g,w as y,M as _,x as w}from"./vue-vendor-FOQ7SlVG.js";import{d as C,u as j}from"./distributionStore-PebOb9Xr.js";import{b as M,_ as V,d as z,e as P,j as B}from"./index-Bkz-5-QE.js";import{_ as U}from"./Input.vue_vue_type_script_setup_true_lang-2ZgOsU_G.js";import{_ as L}from"./Select.vue_vue_type_script_setup_true_lang-CMc7GAxK.js";import{_ as $}from"./Modal.vue_vue_type_script_setup_true_lang-DuZonOwY.js";import{_ as H}from"./Pagination.vue_vue_type_script_setup_true_lang-Bk-fhMrj.js";import{_ as O}from"./Badge.vue_vue_type_script_setup_true_lang-DSCw0GKm.js";import"./utils-vendor-C6ZCcsv1.js";const A=["aria-label"],I={class:"flex items-start justify-between"},D={class:"flex-1"},E={class:"flex items-center gap-3 mb-3"},F={class:"text-lg font-semibold text-neutral-900 dark:text-neutral-900",id:"publication-title"},S={key:0,class:"text-sm text-neutral-600 dark:text-neutral-600 mb-3 line-clamp-2"},q={class:"flex flex-wrap items-center gap-4 text-xs text-neutral-600 dark:text-neutral-600 mb-3"},N={class:"flex items-center gap-1"},G={class:"flex items-center gap-1"},J={class:"flex items-center gap-1"},K={key:1,class:"flex flex-wrap gap-2 mb-3"},Q={key:2,class:"flex items-center gap-4 text-sm"},R={class:"flex items-center gap-1 text-neutral-600 dark:text-neutral-600"},T={class:"flex items-center gap-1 text-neutral-600 dark:text-neutral-600"},W={class:"flex items-center gap-1 text-neutral-600 dark:text-neutral-600"},X={class:"flex items-center gap-2 ml-4"},Y=z(t({__name:"PublicationCard",props:{publication:{}},emits:["preview","edit","delete"],setup(e){const t=e,x=l(()=>({published:"success",scheduled:"warning",draft:"info",archived:"error"}[t.publication.status]||"info")),k=l(()=>({published:"Опубликовано",scheduled:"Запланировано",draft:"Черновик",archived:"Архив"}[t.publication.status]||t.publication.status));return(t,l)=>(n(),a("div",{class:"publication-card",role:"article","aria-label":`Публикация: ${e.publication.title}`},[r(V,null,{default:s(()=>[u("div",I,[u("div",D,[u("div",E,[u("h3",F,o(e.publication.title),1),r(O,{variant:x.value,size:"sm"},{default:s(()=>[d(o(k.value),1)]),_:1},8,["variant"])]),e.publication.description?(n(),a("p",S,o(e.publication.description),1)):i("",!0),u("div",q,[u("div",N,[l[3]||(l[3]=u("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),u("span",null,o(c(M)(e.publication.created_date)),1)]),u("div",G,[l[4]||(l[4]=u("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),u("span",null,o(e.publication.created_by),1)]),u("div",J,[l[5]||(l[5]=u("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),u("span",null,o(e.publication.assets.length)+" активов",1)])]),e.publication.channels&&e.publication.channels.length>0?(n(),a("div",K,[(n(!0),a(v,null,p(e.publication.channels,e=>(n(),m(O,{key:e.id,variant:"info",size:"sm"},{default:s(()=>[d(o(e.name),1)]),_:2},1024))),128))])):i("",!0),e.publication.analytics?(n(),a("div",Q,[u("div",R,[l[6]||(l[6]=u("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)),u("span",null,o(e.publication.analytics.views)+" просмотров",1)]),u("div",T,[l[7]||(l[7]=u("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),u("span",null,o(e.publication.analytics.downloads)+" скачиваний",1)]),u("div",W,[l[8]||(l[8]=u("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.552 3.546a2 2 0 002.938-2.187l.546-2.59A4.998 4.998 0 0017 12c0-.482-.114-.938-.316-1.342m0 2.684L12.448 8.454a2 2 0 00-2.938-2.187l-.546 2.59A4.998 4.998 0 007 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684"})],-1)),u("span",null,o(e.publication.analytics.shares)+" репостов",1)])])):i("",!0)]),u("div",X,[u("button",{type:"button",class:"p-2 text-neutral-600 dark:text-neutral-600 hover:text-primary-500 rounded-md hover:bg-neutral-100 dark:hover:bg-neutral-100 transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center",onClick:l[0]||(l[0]=e=>t.$emit("preview")),"aria-label":"Предпросмотр публикации"},[...l[9]||(l[9]=[u("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])]),u("button",{type:"button",class:"p-2 text-neutral-600 dark:text-neutral-600 hover:text-primary-500 rounded-md hover:bg-neutral-100 dark:hover:bg-neutral-100 transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center",onClick:l[1]||(l[1]=e=>t.$emit("edit")),"aria-label":"Редактировать публикацию"},[...l[10]||(l[10]=[u("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])]),u("button",{type:"button",class:"p-2 text-neutral-600 dark:text-neutral-600 hover:text-error rounded-md hover:bg-neutral-100 dark:hover:bg-neutral-100 transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center",onClick:l[2]||(l[2]=e=>t.$emit("delete")),"aria-label":"Удалить публикацию"},[...l[11]||(l[11]=[u("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])])])])]),_:1})],8,A))}}),[["__scopeId","data-v-dfba90ce"]]),Z={class:"mb-6"},ee={class:"flex items-center justify-between"},te={key:0},le={key:1},ae={key:0,class:"space-y-4"},ne={class:"border border-neutral-300 dark:border-neutral-300 rounded-md p-4 min-h-[200px]"},re={key:0,class:"text-center py-8 text-neutral-600 dark:text-neutral-600"},se={key:1,class:"space-y-2"},ue={class:"flex items-center gap-3"},ie=["src","alt"],oe={class:"font-medium text-sm text-neutral-900 dark:text-neutral-900"},de={class:"text-xs text-neutral-600 dark:text-neutral-600"},ce=["onClick"],ve={key:1,class:"space-y-4"},pe={key:0,class:"text-center py-8 text-neutral-600 dark:text-neutral-600"},me={key:1,class:"space-y-2"},xe=["value","checked","onChange"],ke={class:"flex-1"},be={class:"font-medium text-sm text-neutral-900 dark:text-neutral-900"},he={class:"text-xs text-neutral-600 dark:text-neutral-600"},fe={key:2,class:"space-y-4"},ge={class:"grid grid-cols-2 gap-4"},ye={key:3,class:"space-y-4"},_e={class:"bg-neutral-50 dark:bg-neutral-50 rounded-lg p-4"},we={class:"space-y-2 text-sm"},Ce={class:"ml-2 text-neutral-900 dark:text-neutral-900"},je={class:"ml-2 text-neutral-900 dark:text-neutral-900"},Me={class:"ml-2 text-neutral-900 dark:text-neutral-900"},Ve={key:0},ze={class:"ml-2 text-neutral-900 dark:text-neutral-900"},Pe={class:"flex items-center gap-2"},Be={class:"flex justify-between"},Ue={class:"flex gap-2"},Le=t({__name:"CreatePublicationModal",props:{isOpen:{type:Boolean}},emits:["close","created"],setup(t,{emit:y}){const _=y,w=[{label:"Выбор активов",key:"assets"},{label:"Каналы",key:"channels"},{label:"Настройки",key:"settings"},{label:"Предпросмотр",key:"preview"}],j=x(0),V=x([]),z=x([]),L=x([]),H=x(!1),O=x(!1),A=x({title:"",description:"",asset_ids:[],channel_ids:[],schedule:{}}),I=l(()=>{switch(j.value){case 0:return V.value.length>0;case 1:return L.value.length>0;case 2:return A.value.title.trim().length>0;default:return!0}}),D=l(()=>A.value.title.trim().length>0&&V.value.length>0&&L.value.length>0);function E(){j.value<w.length-1&&I.value&&(j.value++,S())}function F(){j.value>0&&j.value--}function S(){A.value.asset_ids=V.value.map(e=>e.id),A.value.channel_ids=L.value}function q(){}function N(){return e(this,null,function*(){if(D.value&&!O.value){O.value=!0,S();try{const e=yield C.createPublication(A.value);H.value&&(yield C.publishPublication(e.id)),_("created",e),_("close"),j.value=0,V.value=[],L.value=[],H.value=!1,A.value={title:"",description:"",asset_ids:[],channel_ids:[],schedule:{}}}catch(e){}finally{O.value=!1}}})}return k(()=>e(this,null,function*(){yield function(){return e(this,null,function*(){try{z.value=yield C.getChannels()}catch(e){}})}()})),(e,l)=>(n(),m($,{"is-open":t.isOpen,onClose:l[6]||(l[6]=t=>e.$emit("close")),size:"lg"},{header:s(()=>[...l[7]||(l[7]=[u("h2",{class:"text-xl font-semibold text-neutral-900 dark:text-neutral-900"}," Создать публикацию ",-1)])]),body:s(()=>[u("div",Z,[u("div",ee,[(n(),a(v,null,p(w,(e,t)=>u("div",{key:t,class:"flex items-center"},[u("div",{class:g(["w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold",j.value>t||j.value===t?"bg-primary-500 text-white":"bg-neutral-200 dark:bg-neutral-200 text-neutral-600 dark:text-neutral-600"])},[j.value>t?(n(),a("span",te,"✓")):(n(),a("span",le,o(t+1),1))],2),u("span",{class:g(["ml-2 text-sm",j.value>=t?"text-neutral-900 dark:text-neutral-900 font-medium":"text-neutral-600 dark:text-neutral-600"])},o(e.label),3),t<w.length-1?(n(),a("div",{key:0,class:g(["w-12 h-0.5 mx-4",j.value>t?"bg-primary-500":"bg-neutral-200 dark:bg-neutral-200"])},null,2)):i("",!0)])),64))])]),0===j.value?(n(),a("div",ae,[u("div",null,[l[11]||(l[11]=u("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Выберите активы ",-1)),u("div",ne,[0===V.value.length?(n(),a("div",re,[l[9]||(l[9]=u("p",null,"Выберите активы для публикации",-1)),r(P,{variant:"outline",size:"sm",class:"mt-4",onClick:q},{default:s(()=>[...l[8]||(l[8]=[d(" Выбрать активы ",-1)])]),_:1})])):(n(),a("div",se,[(n(!0),a(v,null,p(V.value,e=>(n(),a("div",{key:e.id,class:"flex items-center justify-between p-2 bg-neutral-50 dark:bg-neutral-50 rounded-md"},[u("div",ue,[e.thumbnail_url?(n(),a("img",{key:0,src:e.thumbnail_url,alt:e.label,class:"w-12 h-12 object-cover rounded"},null,8,ie)):i("",!0),u("div",null,[u("div",oe,o(e.label),1),u("div",de,o(c(B)(e.size)),1)])]),u("button",{class:"text-error hover:text-error-dark",onClick:t=>{return l=e.id,void(V.value=V.value.filter(e=>e.id!==l));var l}},[...l[10]||(l[10]=[u("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,ce)]))),128))]))])])])):i("",!0),1===j.value?(n(),a("div",ve,[u("div",null,[l[13]||(l[13]=u("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Выберите каналы ",-1)),0===z.value.length?(n(),a("div",pe,[...l[12]||(l[12]=[u("p",null,"Загрузка каналов...",-1)])])):(n(),a("div",me,[(n(!0),a(v,null,p(z.value,e=>(n(),a("label",{key:e.id,class:"flex items-center p-3 border border-neutral-300 dark:border-neutral-300 rounded-md hover:bg-neutral-50 dark:hover:bg-neutral-50 cursor-pointer"},[u("input",{type:"checkbox",value:e.id,checked:L.value.includes(e.id),onChange:t=>function(e){const t=L.value.indexOf(e);-1===t?L.value.push(e):L.value.splice(t,1)}(e.id),class:"mr-3"},null,40,xe),u("div",ke,[u("div",be,o(e.name),1),u("div",he,o(e.type),1)])]))),128))]))])])):i("",!0),2===j.value?(n(),a("div",fe,[u("div",null,[l[14]||(l[14]=u("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Название публикации ",-1)),r(U,{modelValue:A.value.title,"onUpdate:modelValue":l[0]||(l[0]=e=>A.value.title=e),placeholder:"Введите название",required:""},null,8,["modelValue"])]),u("div",null,[l[15]||(l[15]=u("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Описание (необязательно) ",-1)),b(u("textarea",{"onUpdate:modelValue":l[1]||(l[1]=e=>A.value.description=e),class:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md resize-none focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-neutral-0 dark:text-neutral-900",rows:"3",placeholder:"Введите описание"},null,512),[[h,A.value.description]])]),u("div",ge,[u("div",null,[l[16]||(l[16]=u("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Дата начала ",-1)),b(u("input",{"onUpdate:modelValue":l[2]||(l[2]=e=>A.value.schedule.start_date=e),type:"datetime-local",class:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-neutral-0 dark:text-neutral-900"},null,512),[[h,A.value.schedule.start_date]])]),u("div",null,[l[17]||(l[17]=u("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Дата окончания ",-1)),b(u("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>A.value.schedule.end_date=e),type:"datetime-local",class:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-neutral-0 dark:text-neutral-900"},null,512),[[h,A.value.schedule.end_date]])])])])):i("",!0),3===j.value?(n(),a("div",ye,[u("div",_e,[l[22]||(l[22]=u("h3",{class:"font-semibold text-neutral-900 dark:text-neutral-900 mb-3"}," Предпросмотр публикации ",-1)),u("div",we,[u("div",null,[l[18]||(l[18]=u("span",{class:"text-neutral-600 dark:text-neutral-600"},"Название:",-1)),u("span",Ce,o(A.value.title),1)]),u("div",null,[l[19]||(l[19]=u("span",{class:"text-neutral-600 dark:text-neutral-600"},"Активов:",-1)),u("span",je,o(V.value.length),1)]),u("div",null,[l[20]||(l[20]=u("span",{class:"text-neutral-600 dark:text-neutral-600"},"Каналов:",-1)),u("span",Me,o(L.value.length),1)]),A.value.schedule.start_date?(n(),a("div",Ve,[l[21]||(l[21]=u("span",{class:"text-neutral-600 dark:text-neutral-600"},"Начало:",-1)),u("span",ze,o(c(M)(A.value.schedule.start_date)),1)])):i("",!0)])]),u("div",null,[u("label",Pe,[b(u("input",{"onUpdate:modelValue":l[4]||(l[4]=e=>H.value=e),type:"checkbox",class:"rounded"},null,512),[[f,H.value]]),l[23]||(l[23]=u("span",{class:"text-sm text-neutral-900 dark:text-neutral-900"}," Опубликовать сразу ",-1))])])])):i("",!0)]),footer:s(()=>[u("div",Be,[j.value>0?(n(),m(P,{key:0,variant:"outline",onClick:F},{default:s(()=>[...l[24]||(l[24]=[d(" Назад ",-1)])]),_:1})):i("",!0),l[27]||(l[27]=u("div",null,null,-1)),u("div",Ue,[r(P,{variant:"outline",onClick:l[5]||(l[5]=t=>e.$emit("close"))},{default:s(()=>[...l[25]||(l[25]=[d(" Отмена ",-1)])]),_:1}),j.value<w.length-1?(n(),m(P,{key:0,variant:"primary",disabled:!I.value,onClick:E},{default:s(()=>[...l[26]||(l[26]=[d(" Далее ",-1)])]),_:1},8,["disabled"])):(n(),m(P,{key:1,variant:"primary",disabled:!D.value||O.value,loading:O.value,onClick:N},{default:s(()=>[d(o(H.value?"Опубликовать":"Создать"),1)]),_:1},8,["disabled","loading"]))])])]),_:1},8,["is-open"]))}}),$e={class:"space-y-4"},He={class:"border border-neutral-300 dark:border-neutral-300 rounded-md p-4 min-h-[150px]"},Oe={key:0,class:"text-center py-8 text-neutral-600 dark:text-neutral-600"},Ae={key:1,class:"space-y-2"},Ie={class:"flex items-center gap-3"},De=["src","alt"],Ee={class:"font-medium text-sm text-neutral-900 dark:text-neutral-900"},Fe={class:"text-xs text-neutral-600 dark:text-neutral-600"},Se=["onClick"],qe={key:0,class:"text-center py-4 text-neutral-600 dark:text-neutral-600"},Ne={key:1,class:"space-y-2"},Ge=["value","checked","onChange"],Je={class:"flex-1"},Ke={class:"font-medium text-sm text-neutral-900 dark:text-neutral-900"},Qe={class:"text-xs text-neutral-600 dark:text-neutral-600"},Re={class:"grid grid-cols-2 gap-4"},Te={key:0,class:"p-3 bg-error-50 dark:bg-error-50 rounded-md"},We={class:"text-sm font-medium text-error"},Xe={class:"flex justify-end gap-2"},Ye=t({__name:"EditPublicationModal",props:{isOpen:{type:Boolean},publication:{}},emits:["close","updated"],setup(t,{emit:f}){const g=t,w=f,j=x([]),M=x([]),V=x([]),z=x(!1),L=x(null),H=x({title:"",description:"",asset_ids:[],channel_ids:[],schedule:{},status:"draft"}),O=l(()=>H.value.title.trim().length>0&&j.value.length>0&&V.value.length>0);function A(){return e(this,null,function*(){try{M.value=yield C.getChannels()}catch(e){}})}function I(){}function D(){return e(this,null,function*(){if(O.value&&!z.value&&g.publication){z.value=!0,L.value=null;try{H.value.asset_ids=j.value.map(e=>e.id),H.value.channel_ids=V.value;const e=yield C.updatePublication(g.publication.id,H.value);w("updated",e),w("close")}catch(e){L.value=e.message||"Не удалось сохранить публикацию"}finally{z.value=!1}}})}return y(()=>g.isOpen,t=>e(this,null,function*(){t&&g.publication?(yield function(){if(!g.publication)return;H.value={title:g.publication.title,description:g.publication.description||"",asset_ids:g.publication.assets.map(e=>e.id),channel_ids:g.publication.channels.map(e=>e.id),schedule:g.publication.schedule||{},status:g.publication.status},j.value=[...g.publication.assets],V.value=g.publication.channels.map(e=>e.id)}(),yield A()):t||(j.value=[],V.value=[],L.value=null,H.value={title:"",description:"",asset_ids:[],channel_ids:[],schedule:{},status:"draft"})}),{immediate:!0}),k(()=>e(this,null,function*(){yield A()})),(e,l)=>(n(),m($,{"is-open":t.isOpen,onClose:l[6]||(l[6]=t=>e.$emit("close")),size:"lg"},{header:s(()=>[...l[7]||(l[7]=[u("h2",{class:"text-xl font-semibold text-neutral-900 dark:text-neutral-900"}," Редактировать публикацию ",-1)])]),body:s(()=>[u("div",$e,[u("div",null,[l[8]||(l[8]=u("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Название публикации ",-1)),r(U,{modelValue:H.value.title,"onUpdate:modelValue":l[0]||(l[0]=e=>H.value.title=e),placeholder:"Введите название",required:""},null,8,["modelValue"])]),u("div",null,[l[9]||(l[9]=u("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Описание (необязательно) ",-1)),b(u("textarea",{"onUpdate:modelValue":l[1]||(l[1]=e=>H.value.description=e),class:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md resize-none focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-neutral-0 dark:text-neutral-900",rows:"3",placeholder:"Введите описание"},null,512),[[h,H.value.description]])]),u("div",null,[l[13]||(l[13]=u("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Активы ",-1)),u("div",He,[0===j.value.length?(n(),a("div",Oe,[l[11]||(l[11]=u("p",null,"Нет активов",-1)),r(P,{variant:"outline",size:"sm",class:"mt-4",onClick:I},{default:s(()=>[...l[10]||(l[10]=[d(" Добавить активы ",-1)])]),_:1})])):(n(),a("div",Ae,[(n(!0),a(v,null,p(j.value,e=>(n(),a("div",{key:e.id,class:"flex items-center justify-between p-2 bg-neutral-50 dark:bg-neutral-50 rounded-md"},[u("div",Ie,[e.thumbnail_url?(n(),a("img",{key:0,src:e.thumbnail_url,alt:e.label,class:"w-12 h-12 object-cover rounded"},null,8,De)):i("",!0),u("div",null,[u("div",Ee,o(e.label),1),u("div",Fe,o(c(B)(e.size)),1)])]),u("button",{class:"text-error hover:text-error-dark",onClick:t=>{return l=e.id,j.value=j.value.filter(e=>e.id!==l),void(H.value.asset_ids=j.value.map(e=>e.id));var l}},[...l[12]||(l[12]=[u("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Se)]))),128))]))])]),u("div",null,[l[15]||(l[15]=u("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Каналы ",-1)),0===M.value.length?(n(),a("div",qe,[...l[14]||(l[14]=[u("p",null,"Загрузка каналов...",-1)])])):(n(),a("div",Ne,[(n(!0),a(v,null,p(M.value,e=>(n(),a("label",{key:e.id,class:"flex items-center p-3 border border-neutral-300 dark:border-neutral-300 rounded-md hover:bg-neutral-50 dark:hover:bg-neutral-50 cursor-pointer"},[u("input",{type:"checkbox",value:e.id,checked:V.value.includes(e.id),onChange:t=>function(e){const t=V.value.indexOf(e);-1===t?V.value.push(e):V.value.splice(t,1),H.value.channel_ids=V.value}(e.id),class:"mr-3"},null,40,Ge),u("div",Je,[u("div",Ke,o(e.name),1),u("div",Qe,o(e.type),1)])]))),128))]))]),u("div",Re,[u("div",null,[l[16]||(l[16]=u("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Дата начала ",-1)),b(u("input",{"onUpdate:modelValue":l[2]||(l[2]=e=>H.value.schedule.start_date=e),type:"datetime-local",class:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-neutral-0 dark:text-neutral-900"},null,512),[[h,H.value.schedule.start_date]])]),u("div",null,[l[17]||(l[17]=u("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Дата окончания ",-1)),b(u("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>H.value.schedule.end_date=e),type:"datetime-local",class:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-neutral-0 dark:text-neutral-900"},null,512),[[h,H.value.schedule.end_date]])])]),u("div",null,[l[19]||(l[19]=u("label",{class:"block text-sm font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Статус ",-1)),b(u("select",{"onUpdate:modelValue":l[4]||(l[4]=e=>H.value.status=e),class:"w-full px-4 py-2 border border-neutral-300 dark:border-neutral-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 dark:bg-neutral-0 dark:text-neutral-900"},[...l[18]||(l[18]=[u("option",{value:"draft"},"Черновик",-1),u("option",{value:"scheduled"},"Запланировано",-1),u("option",{value:"published"},"Опубликовано",-1),u("option",{value:"archived"},"Архив",-1)])],512),[[_,H.value.status]])]),L.value?(n(),a("div",Te,[u("p",We,o(L.value),1)])):i("",!0)])]),footer:s(()=>[u("div",Xe,[r(P,{variant:"outline",onClick:l[5]||(l[5]=t=>e.$emit("close"))},{default:s(()=>[...l[20]||(l[20]=[d(" Отмена ",-1)])]),_:1}),r(P,{variant:"primary",disabled:!O.value||z.value,loading:z.value,onClick:D},{default:s(()=>[...l[21]||(l[21]=[d(" Сохранить ",-1)])]),_:1},8,["disabled","loading"])])]),_:1},8,["is-open"]))}}),Ze={class:"distribution-page"},et={class:"flex items-center justify-between mb-6"},tt={class:"mb-6 flex items-center gap-4"},lt={key:0,class:"text-center py-12"},at={key:1,class:"text-center py-12"},nt={class:"max-w-md mx-auto"},rt={class:"mt-2 text-sm text-neutral-600 dark:text-neutral-600"},st={key:2,class:"space-y-4"},ut={key:3,class:"text-center py-12"},it={key:4,class:"mt-6"},ot={class:"text-neutral-900 dark:text-neutral-900"},dt={class:"flex justify-end gap-2"},ct=z(t({__name:"DistributionPage",setup(t){w();const l=j(),b=x(!1),h=x(!1),f=x(!1),g=x(null),_=x(null),C=x(!1),M=x(""),V=x(""),z=[{value:"",label:"Все статусы"},{value:"draft",label:"Черновик"},{value:"scheduled",label:"Запланировано"},{value:"published",label:"Опубликовано"},{value:"archived",label:"Архив"}];function B(e){const t=e||void 0;l.applyFilters({status:t})}function O(){l.applyFilters({search:V.value||void 0})}function A(e){l.setPage(e)}function I(){l.fetchPublications()}function D(){return e(this,null,function*(){if(_.value){C.value=!0;try{yield l.deletePublication(_.value.id),f.value=!1,_.value=null}catch(e){}finally{C.value=!1}}})}function E(e){l.fetchPublications()}function F(e){l.fetchPublications(),h.value=!1,g.value=null}return k(()=>e(this,null,function*(){yield l.fetchPublications()})),y(()=>l.filters,()=>{},{deep:!0}),(e,t)=>(n(),a("div",Ze,[u("div",et,[t[9]||(t[9]=u("div",null,[u("h1",{class:"text-2xl font-bold text-neutral-900 dark:text-neutral-900"}," Публикации "),u("p",{class:"text-sm text-neutral-600 dark:text-neutral-600 mt-1"}," Управление публикациями и их распространением ")],-1)),r(P,{variant:"primary",onClick:t[0]||(t[0]=e=>b.value=!0)},{default:s(()=>[...t[8]||(t[8]=[u("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),d(" Создать публикацию ",-1)])]),_:1})]),u("div",tt,[r(L,{modelValue:M.value,"onUpdate:modelValue":t[1]||(t[1]=e=>M.value=e),options:z,placeholder:"Все статусы",class:"w-48",onChange:B},null,8,["modelValue"]),r(U,{modelValue:V.value,"onUpdate:modelValue":t[2]||(t[2]=e=>V.value=e),placeholder:"Поиск публикаций...",class:"flex-1 max-w-md",onInput:O},{prefix:s(()=>[...t[10]||(t[10]=[u("svg",{class:"w-5 h-5 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)])]),_:1},8,["modelValue"])]),c(l).isLoading&&0===c(l).publications.length?(n(),a("div",lt,[...t[11]||(t[11]=[u("div",{class:"animate-spin h-8 w-8 mx-auto text-primary-500"},null,-1),u("p",{class:"mt-4 text-neutral-600 dark:text-neutral-600"},"Загрузка публикаций...",-1)])])):c(l).error&&0===c(l).publications.length?(n(),a("div",at,[u("div",nt,[t[13]||(t[13]=u("svg",{class:"mx-auto h-12 w-12 text-error",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t[14]||(t[14]=u("h3",{class:"mt-4 text-lg font-medium text-neutral-900 dark:text-neutral-900"}," Ошибка загрузки ",-1)),u("p",rt,o(c(l).error),1),r(P,{variant:"primary",class:"mt-4",onClick:I},{default:s(()=>[...t[12]||(t[12]=[d(" Попробовать снова ",-1)])]),_:1})])])):c(l).publications.length>0?(n(),a("div",st,[(n(!0),a(v,null,p(c(l).publications,e=>(n(),m(Y,{key:e.id,publication:e,onPreview:e=>{},onEdit:t=>function(e){g.value=e,h.value=!0}(e),onDelete:t=>function(e){_.value=e,f.value=!0}(e)},null,8,["publication","onPreview","onEdit","onDelete"]))),128))])):(n(),a("div",ut,[t[16]||(t[16]=u("svg",{class:"mx-auto h-16 w-16 text-neutral-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[u("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})],-1)),t[17]||(t[17]=u("h3",{class:"text-lg font-medium text-neutral-900 dark:text-neutral-900 mb-2"}," Нет публикаций ",-1)),t[18]||(t[18]=u("p",{class:"text-sm text-neutral-600 dark:text-neutral-600 mb-4"}," Создайте первую публикацию для распространения активов ",-1)),r(P,{variant:"primary",onClick:t[3]||(t[3]=e=>b.value=!0)},{default:s(()=>[...t[15]||(t[15]=[d(" Создать публикацию ",-1)])]),_:1})])),c(l).totalCount>0?(n(),a("div",it,[r(H,{"current-page":c(l).currentPage,"total-items":c(l).totalCount,"page-size":c(l).pageSize,onPageChange:A},null,8,["current-page","total-items","page-size"])])):i("",!0),r(Le,{"is-open":b.value,onClose:t[4]||(t[4]=e=>b.value=!1),onCreated:E},null,8,["is-open"]),r(Ye,{"is-open":h.value,publication:g.value,onClose:t[5]||(t[5]=e=>h.value=!1),onUpdated:F},null,8,["is-open","publication"]),r($,{"is-open":f.value,onClose:t[7]||(t[7]=e=>f.value=!1)},{header:s(()=>[...t[19]||(t[19]=[u("h2",{class:"text-xl font-semibold text-neutral-900 dark:text-neutral-900"}," Удалить публикацию? ",-1)])]),body:s(()=>{var e;return[u("p",ot,' Вы уверены, что хотите удалить публикацию "'+o(null==(e=_.value)?void 0:e.title)+'"? Это действие нельзя отменить. ',1)]}),footer:s(()=>[u("div",dt,[r(P,{variant:"outline",onClick:t[6]||(t[6]=e=>f.value=!1)},{default:s(()=>[...t[20]||(t[20]=[d(" Отмена ",-1)])]),_:1}),r(P,{variant:"danger",loading:C.value,onClick:D},{default:s(()=>[...t[21]||(t[21]=[d(" Удалить ",-1)])]),_:1},8,["loading"])])]),_:1},8,["is-open"])]))}}),[["__scopeId","data-v-b917ba74"]]);export{ct as default};
//# sourceMappingURL=DistributionPage-Dh5LvRCZ.js.map
