var t=Object.defineProperty,e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,u=(e,n,i)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i,l=(t,l)=>{for(var a in l||(l={}))n.call(l,a)&&u(t,a,l[a]);if(e)for(var a of e(l))i.call(l,a)&&u(t,a,l[a]);return t},a=(t,e,n)=>new Promise((i,u)=>{var l=t=>{try{r(n.next(t))}catch(e){u(e)}},a=t=>{try{r(n.throw(t))}catch(e){u(e)}},r=t=>t.done?i(t.value):Promise.resolve(t.value).then(l,a);r((n=n.apply(t,e)).next())});import{d as r,r as o,c as s}from"./vue-vendor-B11yH1L4.js";import{a as c,f as v}from"./index-CEUju959.js";const d=new class{getPublications(t){return a(this,null,function*(){const e={};(null==t?void 0:t.page)&&(e.page=t.page),(null==t?void 0:t.page_size)&&(e.page_size=t.page_size),(null==t?void 0:t.status)&&(e.status=t.status),(null==t?void 0:t.search)&&(e.search=t.search);const n=new URLSearchParams;Object.entries(e).forEach(([t,e])=>{n.append(t,String(e))});const i=n.toString().length>0?`/v4/distribution/publications/?${n}`:"/v4/distribution/publications/";return c.get(i,void 0,!1)})}getPublication(t){return a(this,null,function*(){return c.get(`/v4/distribution/publications/${t}/`,void 0,!0)})}createPublication(t){return a(this,null,function*(){return c.post("/v4/distribution/publications/",t)})}updatePublication(t,e){return a(this,null,function*(){return c.put(`/v4/distribution/publications/${t}/`,e)})}deletePublication(t){return a(this,null,function*(){return c.delete(`/v4/distribution/publications/${t}/`)})}publishPublication(t){return a(this,null,function*(){return c.post(`/v4/distribution/publications/${t}/publish/`)})}getShareLinks(t){return a(this,null,function*(){return(yield c.get(`/v4/distribution/publications/${t}/links/`)).results||[]})}createShareLink(t,e){return a(this,null,function*(){return c.post(`/v4/distribution/publications/${t}/links/`,e)})}deleteShareLink(t,e){return a(this,null,function*(){return c.delete(`/v4/distribution/publications/${t}/links/${e}/`)})}getChannels(){return a(this,null,function*(){return(yield c.get("/v4/distribution/channels/")).results||[]})}getPublicationAnalytics(t){return a(this,null,function*(){return c.get(`/v4/distribution/publications/${t}/analytics/`,void 0,!0)})}getPublicationByToken(t){return a(this,null,function*(){return c.get(`/v4/distribution/publications/portal/${t}/`,void 0,!1)})}trackPublicView(t){return a(this,null,function*(){yield c.post(`/v4/distribution/publications/portal/${t}/events/`,{event:"view"})})}trackPublicDownload(t,e){return a(this,null,function*(){yield c.post(`/v4/distribution/publications/portal/${t}/events/`,{event:"download",asset_id:e})})}},b=r("distribution",()=>{const t=o([]),e=o(0),n=o(1),i=o(20),u=o(!1),r=o(null),c=o(null),b=o({}),p=s(()=>{const t=Math.ceil(e.value/i.value);return n.value<t}),h=s(()=>n.value>1),f=s(()=>Math.ceil(e.value/i.value));function g(o){return a(this,null,function*(){u.value=!0,r.value=null;try{const u=l(l({page:n.value,page_size:i.value},b.value),o),a=yield d.getPublications(u);t.value=a.results,e.value=a.count,(null==o?void 0:o.page)&&(n.value=o.page)}catch(a){throw r.value=v(a),t.value=[],e.value=0,a}finally{u.value=!1}})}return{publications:t,totalCount:e,currentPage:n,pageSize:i,isLoading:u,error:r,currentPublication:c,filters:b,hasNextPage:p,hasPreviousPage:h,totalPages:f,fetchPublications:g,getPublication:function(t){return a(this,null,function*(){u.value=!0,r.value=null;try{const e=yield d.getPublication(t);return c.value=e,e}catch(e){throw r.value=v(e),c.value=null,e}finally{u.value=!1}})},createPublication:function(n){return a(this,null,function*(){u.value=!0,r.value=null;try{const i=yield d.createPublication(n);return t.value.unshift(i),e.value++,i}catch(i){throw r.value=v(i),i}finally{u.value=!1}})},updatePublication:function(e,n){return a(this,null,function*(){var i;u.value=!0,r.value=null;try{const u=yield d.updatePublication(e,n),l=t.value.findIndex(t=>t.id===e);return-1!==l&&(t.value[l]=u),(null==(i=c.value)?void 0:i.id)===e&&(c.value=u),u}catch(l){throw r.value=v(l),l}finally{u.value=!1}})},deletePublication:function(n){return a(this,null,function*(){var i;u.value=!0,r.value=null;try{yield d.deletePublication(n),t.value=t.value.filter(t=>t.id!==n),e.value--,(null==(i=c.value)?void 0:i.id)===n&&(c.value=null)}catch(l){throw r.value=v(l),l}finally{u.value=!1}})},publishPublication:function(e){return a(this,null,function*(){var n;u.value=!0,r.value=null;try{const i=yield d.publishPublication(e),u=t.value.findIndex(t=>t.id===e);return-1!==u&&(t.value[u]=i),(null==(n=c.value)?void 0:n.id)===e&&(c.value=i),i}catch(i){throw r.value=v(i),i}finally{u.value=!1}})},setPage:function(t){t>=1&&t<=f.value&&(n.value=t,g())},setPageSize:function(t){i.value=Math.min(Math.max(t,1),100),n.value=1,g()},applyFilters:function(t){b.value=l(l({},b.value),t),n.value=1,g()},clearFilters:function(){b.value={},n.value=1,g()},refresh:function(){g()}}},{persist:{paths:["pageSize","filters"]}});export{d,b as u};
//# sourceMappingURL=distributionStore-C9m_opz9.js.map
