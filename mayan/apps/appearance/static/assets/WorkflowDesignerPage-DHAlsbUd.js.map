{"version":3,"file":"WorkflowDesignerPage-DHAlsbUd.js","sources":["../../src/components/admin/WorkflowCanvas.vue","../../src/components/admin/NodeEditor.vue","../../src/components/admin/TransitionEditor.vue","../../src/pages/admin/WorkflowDesignerPage.vue"],"sourcesContent":["<template>\r\n  <div\r\n    ref=\"canvasRef\"\r\n    class=\"workflow-canvas\"\r\n    :style=\"canvasStyle\"\r\n    @wheel.prevent=\"handleWheel\"\r\n    @mousedown=\"handleMouseDown\"\r\n    @mousemove=\"handleMouseMove\"\r\n    @mouseup=\"handleMouseUp\"\r\n    @mouseleave=\"handleMouseLeave\"\r\n  >\r\n    <!-- Grid Background -->\r\n    <svg\r\n      v-if=\"showGrid\"\r\n      class=\"workflow-canvas__grid\"\r\n      :width=\"canvasWidth\"\r\n      :height=\"canvasHeight\"\r\n    >\r\n      <defs>\r\n        <pattern\r\n          id=\"grid\"\r\n          :width=\"gridSize\"\r\n          :height=\"gridSize\"\r\n          patternUnits=\"userSpaceOnUse\"\r\n        >\r\n          <path\r\n            :d=\"`M ${gridSize} 0 L 0 0 0 ${gridSize}`\"\r\n            fill=\"none\"\r\n            stroke=\"var(--color-border, #e5e7eb)\"\r\n            stroke-width=\"1\"\r\n          />\r\n        </pattern>\r\n      </defs>\r\n      <rect width=\"100%\" height=\"100%\" fill=\"url(#grid)\" />\r\n    </svg>\r\n\r\n    <!-- Nodes -->\r\n    <div\r\n      v-for=\"node in nodes\"\r\n      :key=\"node.id\"\r\n      :class=\"[\r\n        'workflow-node',\r\n        `workflow-node--${node.type}`,\r\n        { 'workflow-node--selected': selectedNodeId === node.id }\r\n      ]\"\r\n      :style=\"getNodeStyle(node)\"\r\n      @mousedown.stop=\"handleNodeMouseDown($event, node)\"\r\n      @click.stop=\"handleNodeClick(node)\"\r\n      :draggable=\"true\"\r\n      @dragstart=\"handleNodeDragStart($event)\"\r\n      @dragend=\"handleNodeDragEnd\"\r\n      role=\"button\"\r\n      tabindex=\"0\"\r\n      :aria-label=\"`Workflow node: ${node.name}`\"\r\n    >\r\n      <div class=\"workflow-node__header\">\r\n        <span class=\"workflow-node__type-icon\">\r\n          <svg\r\n            v-if=\"node.type === 'start'\"\r\n            class=\"w-5 h-5\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n            aria-hidden=\"true\"\r\n          >\r\n            <path\r\n              stroke-linecap=\"round\"\r\n              stroke-linejoin=\"round\"\r\n              stroke-width=\"2\"\r\n              d=\"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z\"\r\n            />\r\n            <path\r\n              stroke-linecap=\"round\"\r\n              stroke-linejoin=\"round\"\r\n              stroke-width=\"2\"\r\n              d=\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n            />\r\n          </svg>\r\n          <svg\r\n            v-else-if=\"node.type === 'end'\"\r\n            class=\"w-5 h-5\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n            aria-hidden=\"true\"\r\n          >\r\n            <path\r\n              stroke-linecap=\"round\"\r\n              stroke-linejoin=\"round\"\r\n              stroke-width=\"2\"\r\n              d=\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n            />\r\n            <path\r\n              stroke-linecap=\"round\"\r\n              stroke-linejoin=\"round\"\r\n              stroke-width=\"2\"\r\n              d=\"M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z\"\r\n            />\r\n          </svg>\r\n          <svg\r\n            v-else\r\n            class=\"w-5 h-5\"\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n            aria-hidden=\"true\"\r\n          >\r\n            <path\r\n              stroke-linecap=\"round\"\r\n              stroke-linejoin=\"round\"\r\n              stroke-width=\"2\"\r\n              d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\r\n            />\r\n          </svg>\r\n        </span>\r\n        <span class=\"workflow-node__name\">{{ node.name }}</span>\r\n      </div>\r\n      <p v-if=\"node.description\" class=\"workflow-node__description\">\r\n        {{ node.description }}\r\n      </p>\r\n    </div>\r\n\r\n    <!-- Transitions (Arrows) -->\r\n    <svg\r\n      class=\"workflow-canvas__transitions\"\r\n      :width=\"canvasWidth\"\r\n      :height=\"canvasHeight\"\r\n    >\r\n      <defs>\r\n        <marker\r\n          id=\"arrowhead\"\r\n          markerWidth=\"10\"\r\n          markerHeight=\"10\"\r\n          refX=\"9\"\r\n          refY=\"3\"\r\n          orient=\"auto\"\r\n        >\r\n          <polygon points=\"0 0, 10 3, 0 6\" fill=\"var(--color-text, #111827)\" />\r\n        </marker>\r\n      </defs>\r\n      <g\r\n        v-for=\"transition in transitions\"\r\n        :key=\"transition.id\"\r\n        @click.stop=\"handleTransitionClick(transition)\"\r\n        class=\"workflow-transition\"\r\n        :class=\"{ 'workflow-transition--selected': selectedTransitionId === transition.id }\"\r\n      >\r\n        <path\r\n          :d=\"getTransitionPath(transition)\"\r\n          fill=\"none\"\r\n          stroke=\"var(--color-text, #111827)\"\r\n          stroke-width=\"2\"\r\n          marker-end=\"url(#arrowhead)\"\r\n          class=\"workflow-transition__line\"\r\n        />\r\n        <text\r\n          :x=\"getTransitionLabelX(transition)\"\r\n          :y=\"getTransitionLabelY(transition)\"\r\n          class=\"workflow-transition__label\"\r\n          text-anchor=\"middle\"\r\n          dominant-baseline=\"middle\"\r\n        >\r\n          {{ transition.label || 'â†’' }}\r\n        </text>\r\n      </g>\r\n    </svg>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, onMounted, onUnmounted } from 'vue'\r\nimport type { WorkflowNode, WorkflowTransition } from '@/types/admin'\r\n\r\ninterface Props {\r\n  nodes: WorkflowNode[]\r\n  transitions: WorkflowTransition[]\r\n  zoom: number\r\n  pan: { x: number; y: number }\r\n  selectedNodeId?: string | null\r\n  selectedTransitionId?: string | null\r\n  showGrid?: boolean\r\n}\r\n\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  zoom: 1,\r\n  pan: () => ({ x: 0, y: 0 }),\r\n  selectedNodeId: null,\r\n  selectedTransitionId: null,\r\n  showGrid: true\r\n})\r\n\r\nconst emit = defineEmits<{\r\n  'node-click': [node: WorkflowNode]\r\n  'transition-click': [transition: WorkflowTransition]\r\n  'node-drag': [nodeId: string, position: { x: number; y: number }]\r\n  'pan-change': [pan: { x: number; y: number }]\r\n  'zoom-change': [zoom: number]\r\n}>()\r\n\r\nconst canvasRef = ref<HTMLElement | null>(null)\r\nconst canvasWidth = ref(2000)\r\nconst canvasHeight = ref(2000)\r\nconst gridSize = 20\r\nconst isPanning = ref(false)\r\nconst panStart = ref({ x: 0, y: 0 })\r\nconst isDragging = ref(false)\r\nconst dragNodeId = ref<string | null>(null)\r\nconst dragStart = ref({ x: 0, y: 0 })\r\n\r\nconst canvasStyle = computed(() => {\r\n  return {\r\n    transform: `translate(${props.pan.x}px, ${props.pan.y}px) scale(${props.zoom})`,\r\n    transformOrigin: '0 0'\r\n  }\r\n})\r\n\r\nconst getNodeStyle = (node: WorkflowNode) => {\r\n  return {\r\n    left: `${node.position.x}px`,\r\n    top: `${node.position.y}px`\r\n  }\r\n}\r\n\r\nconst getTransitionPath = (transition: WorkflowTransition): string => {\r\n  const fromNode = props.nodes.find((n) => n.id === transition.from_node)\r\n  const toNode = props.nodes.find((n) => n.id === transition.to_node)\r\n\r\n  if (!fromNode || !toNode) return ''\r\n\r\n  const fromX = fromNode.position.x + 100 // Node width / 2\r\n  const fromY = fromNode.position.y + 50 // Node height / 2\r\n  const toX = toNode.position.x + 100\r\n  const toY = toNode.position.y + 50\r\n\r\n  // Calculate control points for curved line\r\n  const dx = toX - fromX\r\n  const controlX1 = fromX + dx * 0.5\r\n  const controlY1 = fromY\r\n  const controlX2 = toX - dx * 0.5\r\n  const controlY2 = toY\r\n\r\n  return `M ${fromX} ${fromY} C ${controlX1} ${controlY1}, ${controlX2} ${controlY2}, ${toX} ${toY}`\r\n}\r\n\r\nconst getTransitionLabelX = (transition: WorkflowTransition): number => {\r\n  const fromNode = props.nodes.find((n) => n.id === transition.from_node)\r\n  const toNode = props.nodes.find((n) => n.id === transition.to_node)\r\n  if (!fromNode || !toNode) return 0\r\n  return (fromNode.position.x + toNode.position.x) / 2 + 100\r\n}\r\n\r\nconst getTransitionLabelY = (transition: WorkflowTransition): number => {\r\n  const fromNode = props.nodes.find((n) => n.id === transition.from_node)\r\n  const toNode = props.nodes.find((n) => n.id === transition.to_node)\r\n  if (!fromNode || !toNode) return 0\r\n  return (fromNode.position.y + toNode.position.y) / 2 + 50\r\n}\r\n\r\nconst handleWheel = (event: WheelEvent): void => {\r\n  const delta = event.deltaY > 0 ? -0.1 : 0.1\r\n  const newZoom = Math.max(0.5, Math.min(2, props.zoom + delta))\r\n  emit('zoom-change', newZoom)\r\n}\r\n\r\nconst handleMouseDown = (event: MouseEvent): void => {\r\n  if (event.button === 1 || (event.button === 0 && event.ctrlKey)) {\r\n    // Middle mouse or Ctrl+Left for panning\r\n    isPanning.value = true\r\n    panStart.value = { x: event.clientX - props.pan.x, y: event.clientY - props.pan.y }\r\n    event.preventDefault()\r\n  }\r\n}\r\n\r\nconst handleMouseMove = (event: MouseEvent): void => {\r\n  if (isPanning.value) {\r\n    emit('pan-change', {\r\n      x: event.clientX - panStart.value.x,\r\n      y: event.clientY - panStart.value.y\r\n    })\r\n  } else if (isDragging.value && dragNodeId.value) {\r\n    const rect = canvasRef.value?.getBoundingClientRect()\r\n    if (rect) {\r\n      const x = (event.clientX - rect.left - props.pan.x) / props.zoom\r\n      const y = (event.clientY - rect.top - props.pan.y) / props.zoom\r\n      emit('node-drag', dragNodeId.value, { x, y })\r\n    }\r\n  }\r\n}\r\n\r\nconst handleMouseUp = (): void => {\r\n  isPanning.value = false\r\n  isDragging.value = false\r\n  dragNodeId.value = null\r\n}\r\n\r\nconst handleMouseLeave = (): void => {\r\n  isPanning.value = false\r\n  isDragging.value = false\r\n  dragNodeId.value = null\r\n}\r\n\r\nconst handleNodeMouseDown = (event: MouseEvent, node: WorkflowNode): void => {\r\n  if (event.button === 0 && !event.ctrlKey) {\r\n    isDragging.value = true\r\n    dragNodeId.value = node.id\r\n    const rect = canvasRef.value?.getBoundingClientRect()\r\n    if (rect) {\r\n      dragStart.value = {\r\n        x: event.clientX - rect.left - node.position.x * props.zoom,\r\n        y: event.clientY - rect.top - node.position.y * props.zoom\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst handleNodeClick = (node: WorkflowNode): void => {\r\n  emit('node-click', node)\r\n}\r\n\r\nconst handleNodeDragStart = (event: DragEvent): void => {\r\n  // Prevent default drag behavior, we handle it manually\r\n  event.preventDefault()\r\n}\r\n\r\nconst handleNodeDragEnd = (): void => {\r\n  isDragging.value = false\r\n  dragNodeId.value = null\r\n}\r\n\r\nconst handleTransitionClick = (transition: WorkflowTransition): void => {\r\n  emit('transition-click', transition)\r\n}\r\n\r\nonMounted(() => {\r\n  if (canvasRef.value) {\r\n    canvasWidth.value = canvasRef.value.offsetWidth || 2000\r\n    canvasHeight.value = canvasRef.value.offsetHeight || 2000\r\n  }\r\n})\r\n\r\nonUnmounted(() => {\r\n  isPanning.value = false\r\n  isDragging.value = false\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"css\">\r\n.workflow-canvas {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n  background: var(--color-bg-1, #f9fafb);\r\n  cursor: grab;\r\n}\r\n\r\n.workflow-canvas:active {\r\n  cursor: grabbing;\r\n}\r\n\r\n.workflow-canvas__grid {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  pointer-events: none;\r\n}\r\n\r\n.workflow-canvas__transitions {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  pointer-events: stroke;\r\n}\r\n\r\n.workflow-node {\r\n  position: absolute;\r\n  width: 200px;\r\n  min-height: 80px;\r\n  padding: 12px;\r\n  background: var(--color-surface, #ffffff);\r\n  border: 2px solid var(--color-border, #e5e7eb);\r\n  border-radius: var(--radius-lg, 8px);\r\n  cursor: move;\r\n  transition: all 150ms ease;\r\n  box-shadow: var(--shadow-sm, 0 1px 3px rgba(0, 0, 0, 0.1));\r\n}\r\n\r\n.workflow-node:hover {\r\n  border-color: var(--color-primary, #3b82f6);\r\n  box-shadow: var(--shadow-md, 0 4px 6px rgba(0, 0, 0, 0.1));\r\n}\r\n\r\n.workflow-node--selected {\r\n  border-color: var(--color-primary, #3b82f6);\r\n  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);\r\n}\r\n\r\n.workflow-node--start {\r\n  border-color: var(--color-success, #10b981);\r\n}\r\n\r\n.workflow-node--end {\r\n  border-color: var(--color-error, #ef4444);\r\n}\r\n\r\n.workflow-node__header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  margin-bottom: 8px;\r\n}\r\n\r\n.workflow-node__type-icon {\r\n  display: flex;\r\n  align-items: center;\r\n  color: var(--color-text-secondary, #6b7280);\r\n}\r\n\r\n.workflow-node__name {\r\n  font-weight: 600;\r\n  color: var(--color-text, #111827);\r\n  font-size: var(--font-size-base, 14px);\r\n}\r\n\r\n.workflow-node__description {\r\n  font-size: var(--font-size-sm, 12px);\r\n  color: var(--color-text-secondary, #6b7280);\r\n  margin: 0;\r\n}\r\n\r\n.workflow-transition {\r\n  cursor: pointer;\r\n}\r\n\r\n.workflow-transition__line {\r\n  transition: stroke-width 150ms ease;\r\n}\r\n\r\n.workflow-transition:hover .workflow-transition__line {\r\n  stroke-width: 3;\r\n  stroke: var(--color-primary, #3b82f6);\r\n}\r\n\r\n.workflow-transition--selected .workflow-transition__line {\r\n  stroke: var(--color-primary, #3b82f6);\r\n  stroke-width: 3;\r\n}\r\n\r\n.workflow-transition__label {\r\n  font-size: 12px;\r\n  fill: var(--color-text, #111827);\r\n  pointer-events: none;\r\n  background: var(--color-surface, #ffffff);\r\n  padding: 2px 4px;\r\n}\r\n</style>\r\n\r\n","<template>\r\n  <div class=\"node-editor\">\r\n    <div class=\"node-editor__header\">\r\n      <h3 class=\"node-editor__title\">Node Properties</h3>\r\n      <Button\r\n        variant=\"ghost\"\r\n        size=\"sm\"\r\n        @click=\"$emit('cancel')\"\r\n        aria-label=\"Close editor\"\r\n      >\r\n        <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\r\n        </svg>\r\n      </Button>\r\n    </div>\r\n\r\n    <form @submit.prevent=\"handleSave\" class=\"node-editor__form\">\r\n      <!-- Node Name -->\r\n      <div class=\"form-group\">\r\n        <Input\r\n          v-model=\"formData.name\"\r\n          label=\"Node Name\"\r\n          required\r\n          :error=\"errors.name\"\r\n        />\r\n      </div>\r\n\r\n      <!-- Node Type -->\r\n      <div class=\"form-group\">\r\n        <Select\r\n          v-model=\"formData.type\"\r\n          :options=\"nodeTypeOptions\"\r\n          label=\"Node Type\"\r\n          required\r\n          :error=\"errors.type\"\r\n          :disabled=\"formData.type === 'start'\"\r\n        />\r\n      </div>\r\n\r\n      <!-- Description -->\r\n      <div class=\"form-group\">\r\n        <label class=\"form-label\">Description</label>\r\n        <textarea\r\n          v-model=\"formData.description\"\r\n          class=\"form-textarea\"\r\n          rows=\"3\"\r\n          placeholder=\"Optional description\"\r\n        />\r\n      </div>\r\n\r\n      <!-- Allowed Roles -->\r\n      <div class=\"form-group\">\r\n        <label class=\"form-label\">Allowed Roles</label>\r\n        <div class=\"role-checkboxes\">\r\n          <label\r\n            v-for=\"role in roleOptions\"\r\n            :key=\"role.value\"\r\n            class=\"checkbox-label\"\r\n          >\r\n            <input\r\n              type=\"checkbox\"\r\n              :value=\"role.value\"\r\n              :checked=\"formData.allowed_roles.includes(role.value)\"\r\n              @change=\"handleRoleChange(role.value, $event)\"\r\n              class=\"checkbox-input\"\r\n            />\r\n            <span>{{ role.label }}</span>\r\n          </label>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Actions -->\r\n      <div class=\"form-group\">\r\n        <label class=\"form-label\">Available Actions</label>\r\n        <div class=\"action-checkboxes\">\r\n          <label\r\n            v-for=\"action in actionOptions\"\r\n            :key=\"action.value\"\r\n            class=\"checkbox-label\"\r\n          >\r\n            <input\r\n              type=\"checkbox\"\r\n              :value=\"action.value\"\r\n              :checked=\"formData.actions.some((a) => a.action_type === action.value)\"\r\n              @change=\"handleActionChange(action.value, $event)\"\r\n              class=\"checkbox-input\"\r\n            />\r\n            <span>{{ action.label }}</span>\r\n          </label>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Actions -->\r\n      <div class=\"node-editor__actions\">\r\n        <Button\r\n          variant=\"danger\"\r\n          size=\"sm\"\r\n          @click=\"handleDelete\"\r\n          type=\"button\"\r\n        >\r\n          Delete Node\r\n        </Button>\r\n        <Button variant=\"primary\" type=\"submit\" :loading=\"isSaving\">\r\n          Save Node\r\n        </Button>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, reactive, watch } from 'vue'\r\nimport type { WorkflowNode, UserRole, WorkflowAction } from '@/types/admin'\r\nimport Input from '@/components/Common/Input.vue'\r\nimport Select from '@/components/Common/Select.vue'\r\nimport Button from '@/components/Common/Button.vue'\r\n\r\ninterface Props {\r\n  node: WorkflowNode\r\n  workflowNodes: WorkflowNode[]\r\n}\r\n\r\nconst props = defineProps<Props>()\r\n\r\nconst emit = defineEmits<{\r\n  save: [node: WorkflowNode]\r\n  delete: [nodeId: string]\r\n  cancel: []\r\n}>()\r\n\r\nconst isSaving = ref(false)\r\nconst errors = reactive<{ name?: string; type?: string }>({})\r\n\r\nconst formData = reactive<{\r\n  name: string\r\n  type: 'start' | 'state' | 'end'\r\n  description: string\r\n  allowed_roles: UserRole[]\r\n  actions: WorkflowAction[]\r\n}>({\r\n  name: props.node.name,\r\n  type: props.node.type,\r\n  description: props.node.description || '',\r\n  allowed_roles: [...props.node.allowed_roles],\r\n  actions: [...props.node.actions]\r\n})\r\n\r\nconst nodeTypeOptions = [\r\n  { value: 'start', label: 'Start' },\r\n  { value: 'state', label: 'State' },\r\n  { value: 'end', label: 'End' }\r\n]\r\n\r\nconst roleOptions = [\r\n  { value: 'admin', label: 'Administrator' },\r\n  { value: 'editor', label: 'Editor' },\r\n  { value: 'viewer', label: 'Viewer' }\r\n]\r\n\r\nconst actionOptions = [\r\n  { value: 'approve', label: 'Approve' },\r\n  { value: 'reject', label: 'Reject' },\r\n  { value: 'request_changes', label: 'Request Changes' },\r\n  { value: 'publish', label: 'Publish' },\r\n  { value: 'archive', label: 'Archive' }\r\n]\r\n\r\nwatch(\r\n  () => props.node,\r\n  (newNode) => {\r\n    formData.name = newNode.name\r\n    formData.type = newNode.type\r\n    formData.description = newNode.description || ''\r\n    formData.allowed_roles = [...newNode.allowed_roles]\r\n    formData.actions = [...newNode.actions]\r\n  },\r\n  { immediate: true }\r\n)\r\n\r\nconst handleRoleChange = (role: UserRole, event: Event): void => {\r\n  const checked = (event.target as HTMLInputElement).checked\r\n  if (checked) {\r\n    if (!formData.allowed_roles.includes(role)) {\r\n      formData.allowed_roles.push(role)\r\n    }\r\n  } else {\r\n    formData.allowed_roles = formData.allowed_roles.filter((r) => r !== role)\r\n  }\r\n}\r\n\r\nconst handleActionChange = (actionType: string, event: Event): void => {\r\n  const checked = (event.target as HTMLInputElement).checked\r\n  if (checked) {\r\n    const action: WorkflowAction = {\r\n      id: `action-${Date.now()}`,\r\n      label: actionOptions.find((a) => a.value === actionType)?.label || actionType,\r\n      action_type: actionType as WorkflowAction['action_type'],\r\n      target_node_id: ''\r\n    }\r\n    formData.actions.push(action)\r\n  } else {\r\n    formData.actions = formData.actions.filter(\r\n      (a) => a.action_type !== actionType\r\n    )\r\n  }\r\n}\r\n\r\nconst validate = (): boolean => {\r\n  Object.keys(errors).forEach((key) => delete errors[key as keyof typeof errors])\r\n\r\n  if (!formData.name.trim()) {\r\n    errors.name = 'Node name is required'\r\n  }\r\n\r\n  return Object.keys(errors).length === 0\r\n}\r\n\r\nconst handleSave = (): void => {\r\n  if (!validate()) return\r\n\r\n  isSaving.value = true\r\n  try {\r\n    const updatedNode: WorkflowNode = {\r\n      ...props.node,\r\n      name: formData.name.trim(),\r\n      type: formData.type,\r\n      description: formData.description.trim() || undefined,\r\n      allowed_roles: formData.allowed_roles,\r\n      actions: formData.actions\r\n    }\r\n    emit('save', updatedNode)\r\n  } finally {\r\n    isSaving.value = false\r\n  }\r\n}\r\n\r\nconst handleDelete = (): void => {\r\n  if (confirm('Delete this node? All connected transitions will also be removed.')) {\r\n    emit('delete', props.node.id)\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"css\">\r\n.node-editor {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  padding: 16px;\r\n}\r\n\r\n.node-editor__header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  margin-bottom: 16px;\r\n  padding-bottom: 16px;\r\n  border-bottom: 1px solid var(--color-border, #e5e7eb);\r\n}\r\n\r\n.node-editor__title {\r\n  font-size: var(--font-size-lg, 18px);\r\n  font-weight: 600;\r\n  color: var(--color-text, #111827);\r\n}\r\n\r\n.node-editor__form {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16px;\r\n}\r\n\r\n.form-group {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n}\r\n\r\n.form-label {\r\n  font-size: var(--font-size-sm, 12px);\r\n  font-weight: 500;\r\n  color: var(--color-text, #111827);\r\n}\r\n\r\n.form-textarea {\r\n  width: 100%;\r\n  padding: 8px 12px;\r\n  border: 1px solid var(--color-border, #e5e7eb);\r\n  border-radius: var(--radius-base, 6px);\r\n  font-size: var(--font-size-base, 14px);\r\n  font-family: inherit;\r\n  resize: vertical;\r\n}\r\n\r\n.role-checkboxes,\r\n.action-checkboxes {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n}\r\n\r\n.checkbox-label {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  cursor: pointer;\r\n  font-size: var(--font-size-base, 14px);\r\n  color: var(--color-text, #111827);\r\n}\r\n\r\n.checkbox-input {\r\n  width: 18px;\r\n  height: 18px;\r\n  cursor: pointer;\r\n}\r\n\r\n.node-editor__actions {\r\n  display: flex;\r\n  gap: 8px;\r\n  justify-content: flex-end;\r\n  padding-top: 16px;\r\n  border-top: 1px solid var(--color-border, #e5e7eb);\r\n  margin-top: auto;\r\n}\r\n</style>\r\n\r\n\r\n\r\n","<template>\r\n  <div class=\"transition-editor\">\r\n    <div class=\"transition-editor__header\">\r\n      <h3 class=\"transition-editor__title\">Transition Properties</h3>\r\n      <Button\r\n        variant=\"ghost\"\r\n        size=\"sm\"\r\n        @click=\"$emit('cancel')\"\r\n        aria-label=\"Close editor\"\r\n      >\r\n        <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\" />\r\n        </svg>\r\n      </Button>\r\n    </div>\r\n\r\n    <form @submit.prevent=\"handleSave\" class=\"transition-editor__form\">\r\n      <!-- From Node (read-only) -->\r\n      <div class=\"form-group\">\r\n        <label class=\"form-label\">From Node</label>\r\n        <Input\r\n          :model-value=\"fromNodeName\"\r\n          disabled\r\n          readonly\r\n        />\r\n      </div>\r\n\r\n      <!-- To Node (read-only) -->\r\n      <div class=\"form-group\">\r\n        <label class=\"form-label\">To Node</label>\r\n        <Input\r\n          :model-value=\"toNodeName\"\r\n          disabled\r\n          readonly\r\n        />\r\n      </div>\r\n\r\n      <!-- Label -->\r\n      <div class=\"form-group\">\r\n        <Input\r\n          v-model=\"formData.label\"\r\n          label=\"Label\"\r\n          placeholder=\"e.g., Approve\"\r\n          required\r\n          :error=\"errors.label\"\r\n        />\r\n      </div>\r\n\r\n      <!-- Description -->\r\n      <div class=\"form-group\">\r\n        <label class=\"form-label\">Description</label>\r\n        <textarea\r\n          v-model=\"formData.description\"\r\n          class=\"form-textarea\"\r\n          rows=\"3\"\r\n          placeholder=\"Optional description\"\r\n        />\r\n      </div>\r\n\r\n      <!-- Condition Type -->\r\n      <div class=\"form-group\">\r\n        <Select\r\n          v-model=\"conditionType\"\r\n          :options=\"conditionTypeOptions\"\r\n          label=\"Condition Type\"\r\n          @change=\"handleConditionTypeChange\"\r\n        />\r\n      </div>\r\n\r\n      <!-- Condition Parameters -->\r\n      <div v-if=\"conditionType !== 'none'\" class=\"form-group\">\r\n        <div v-if=\"conditionType === 'role'\" class=\"condition-params\">\r\n          <Select\r\n            v-model=\"conditionRole\"\r\n            :options=\"roleOptions\"\r\n            label=\"Required Role\"\r\n          />\r\n        </div>\r\n        <div v-if=\"conditionType === 'action'\" class=\"condition-params\">\r\n          <Select\r\n            v-model=\"conditionAction\"\r\n            :options=\"actionOptions\"\r\n            label=\"Required Action\"\r\n          />\r\n        </div>\r\n        <div v-if=\"conditionType === 'time'\" class=\"condition-params\">\r\n          <Input\r\n            v-model.number=\"conditionDays\"\r\n            type=\"number\"\r\n            label=\"Days\"\r\n            placeholder=\"0\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Actions -->\r\n      <div class=\"transition-editor__actions\">\r\n        <Button\r\n          variant=\"danger\"\r\n          size=\"sm\"\r\n          @click=\"handleDelete\"\r\n          type=\"button\"\r\n        >\r\n          Delete Transition\r\n        </Button>\r\n        <Button variant=\"primary\" type=\"submit\" :loading=\"isSaving\">\r\n          Save Transition\r\n        </Button>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, reactive, computed, watch } from 'vue'\r\nimport type {\r\n  WorkflowTransition,\r\n  WorkflowNode,\r\n  WorkflowCondition\r\n} from '@/types/admin'\r\nimport Input from '@/components/Common/Input.vue'\r\nimport Select from '@/components/Common/Select.vue'\r\nimport Button from '@/components/Common/Button.vue'\r\n\r\ninterface Props {\r\n  transition: WorkflowTransition\r\n  workflowNodes: WorkflowNode[]\r\n}\r\n\r\nconst props = defineProps<Props>()\r\n\r\nconst emit = defineEmits<{\r\n  save: [transition: WorkflowTransition]\r\n  delete: [transitionId: string]\r\n  cancel: []\r\n}>()\r\n\r\nconst isSaving = ref(false)\r\nconst errors = reactive<{ label?: string }>({})\r\n\r\nconst formData = reactive<{\r\n  label: string\r\n  description: string\r\n  condition?: WorkflowCondition\r\n}>({\r\n  label: props.transition.label || '',\r\n  description: props.transition.description || '',\r\n  condition: props.transition.condition\r\n})\r\n\r\nconst conditionType = ref<'none' | 'role' | 'action' | 'time'>('none')\r\nconst conditionRole = ref<string>('')\r\nconst conditionAction = ref<string>('')\r\nconst conditionDays = ref<number>(0)\r\n\r\nconst fromNodeName = computed(() => {\r\n  const node = props.workflowNodes.find((n) => n.id === props.transition.from_node)\r\n  return node?.name || props.transition.from_node\r\n})\r\n\r\nconst toNodeName = computed(() => {\r\n  const node = props.workflowNodes.find((n) => n.id === props.transition.to_node)\r\n  return node?.name || props.transition.to_node\r\n})\r\n\r\nconst conditionTypeOptions = [\r\n  { value: 'none', label: 'No Condition' },\r\n  { value: 'role', label: 'User Role' },\r\n  { value: 'action', label: 'User Action' },\r\n  { value: 'time', label: 'Time-based' }\r\n]\r\n\r\nconst roleOptions = [\r\n  { value: 'admin', label: 'Administrator' },\r\n  { value: 'editor', label: 'Editor' },\r\n  { value: 'viewer', label: 'Viewer' }\r\n]\r\n\r\nconst actionOptions = [\r\n  { value: 'approve', label: 'Approve' },\r\n  { value: 'reject', label: 'Reject' },\r\n  { value: 'request_changes', label: 'Request Changes' },\r\n  { value: 'publish', label: 'Publish' },\r\n  { value: 'archive', label: 'Archive' }\r\n]\r\n\r\nwatch(\r\n  () => props.transition,\r\n  (newTransition) => {\r\n    formData.label = newTransition.label || ''\r\n    formData.description = newTransition.description || ''\r\n    formData.condition = newTransition.condition\r\n\r\n    // Parse condition\r\n    if (newTransition.condition) {\r\n      const cond = newTransition.condition\r\n      if (cond.field === 'role') {\r\n        conditionType.value = 'role'\r\n        conditionRole.value = String(cond.value)\r\n      } else if (cond.field === 'action') {\r\n        conditionType.value = 'action'\r\n        conditionAction.value = String(cond.value)\r\n      } else if (cond.field === 'days') {\r\n        conditionType.value = 'time'\r\n        conditionDays.value = Number(cond.value)\r\n      }\r\n    } else {\r\n      conditionType.value = 'none'\r\n    }\r\n  },\r\n  { immediate: true }\r\n)\r\n\r\nconst handleConditionTypeChange = (): void => {\r\n  formData.condition = undefined\r\n  conditionRole.value = ''\r\n  conditionAction.value = ''\r\n  conditionDays.value = 0\r\n}\r\n\r\nconst validate = (): boolean => {\r\n  Object.keys(errors).forEach((key) => delete errors[key as keyof typeof errors])\r\n\r\n  if (!formData.label.trim()) {\r\n    errors.label = 'Transition label is required'\r\n  }\r\n\r\n  return Object.keys(errors).length === 0\r\n}\r\n\r\nconst handleSave = (): void => {\r\n  if (!validate()) return\r\n\r\n  isSaving.value = true\r\n  try {\r\n    let condition: WorkflowCondition | undefined = undefined\r\n\r\n    if (conditionType.value !== 'none') {\r\n      switch (conditionType.value) {\r\n        case 'role':\r\n          condition = {\r\n            field: 'role',\r\n            operator: 'equals',\r\n            value: conditionRole.value\r\n          }\r\n          break\r\n        case 'action':\r\n          condition = {\r\n            field: 'action',\r\n            operator: 'equals',\r\n            value: conditionAction.value\r\n          }\r\n          break\r\n        case 'time':\r\n          condition = {\r\n            field: 'days',\r\n            operator: 'greater_than',\r\n            value: conditionDays.value\r\n          }\r\n          break\r\n      }\r\n    }\r\n\r\n    const updatedTransition: WorkflowTransition = {\r\n      ...props.transition,\r\n      label: formData.label.trim(),\r\n      description: formData.description.trim() || undefined,\r\n      condition\r\n    }\r\n    emit('save', updatedTransition)\r\n  } finally {\r\n    isSaving.value = false\r\n  }\r\n}\r\n\r\nconst handleDelete = (): void => {\r\n  if (confirm('Delete this transition?')) {\r\n    emit('delete', props.transition.id)\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"css\">\r\n.transition-editor {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  padding: 16px;\r\n}\r\n\r\n.transition-editor__header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  margin-bottom: 16px;\r\n  padding-bottom: 16px;\r\n  border-bottom: 1px solid var(--color-border, #e5e7eb);\r\n}\r\n\r\n.transition-editor__title {\r\n  font-size: var(--font-size-lg, 18px);\r\n  font-weight: 600;\r\n  color: var(--color-text, #111827);\r\n}\r\n\r\n.transition-editor__form {\r\n  flex: 1;\r\n  overflow-y: auto;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16px;\r\n}\r\n\r\n.form-group {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 8px;\r\n}\r\n\r\n.form-label {\r\n  font-size: var(--font-size-sm, 12px);\r\n  font-weight: 500;\r\n  color: var(--color-text, #111827);\r\n}\r\n\r\n.form-textarea {\r\n  width: 100%;\r\n  padding: 8px 12px;\r\n  border: 1px solid var(--color-border, #e5e7eb);\r\n  border-radius: var(--radius-base, 6px);\r\n  font-size: var(--font-size-base, 14px);\r\n  font-family: inherit;\r\n  resize: vertical;\r\n}\r\n\r\n.condition-params {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 12px;\r\n}\r\n\r\n.transition-editor__actions {\r\n  display: flex;\r\n  gap: 8px;\r\n  justify-content: flex-end;\r\n  padding-top: 16px;\r\n  border-top: 1px solid var(--color-border, #e5e7eb);\r\n  margin-top: auto;\r\n}\r\n</style>\r\n\r\n\r\n\r\n","<template>\r\n  <div class=\"workflow-designer\">\r\n    <!-- Toolbar -->\r\n    <div class=\"workflow-designer__toolbar\">\r\n      <Button\r\n        v-if=\"canCreateWorkflow\"\r\n        variant=\"primary\"\r\n        @click=\"handleCreateWorkflow\"\r\n        aria-label=\"Create new workflow\"\r\n      >\r\n        <svg\r\n          class=\"w-5 h-5\"\r\n          fill=\"none\"\r\n          stroke=\"currentColor\"\r\n          viewBox=\"0 0 24 24\"\r\n          aria-hidden=\"true\"\r\n        >\r\n          <path\r\n            stroke-linecap=\"round\"\r\n            stroke-linejoin=\"round\"\r\n            stroke-width=\"2\"\r\n            d=\"M12 4v16m8-8H4\"\r\n          />\r\n        </svg>\r\n        Create Workflow\r\n      </Button>\r\n\r\n      <div v-if=\"currentWorkflow\" class=\"workflow-designer__workflow-info\">\r\n        <Input\r\n          v-model=\"workflowFormData.name\"\r\n          placeholder=\"Workflow name\"\r\n          class=\"workflow-name-input\"\r\n        />\r\n        <Button\r\n          variant=\"secondary\"\r\n          size=\"sm\"\r\n          @click=\"handleSaveWorkflow\"\r\n          :loading=\"isSavingWorkflow\"\r\n          :disabled=\"!hasWorkflowChanges\"\r\n        >\r\n          Save\r\n        </Button>\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"sm\"\r\n          @click=\"handleDeleteWorkflow\"\r\n          :disabled=\"!canDeleteWorkflow\"\r\n        >\r\n          Delete\r\n        </Button>\r\n      </div>\r\n\r\n      <div class=\"workflow-designer__zoom-controls\">\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"sm\"\r\n          @click=\"handleZoomOut\"\r\n          :disabled=\"zoom <= 0.5\"\r\n          aria-label=\"Zoom out\"\r\n        >\r\n          <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7\" />\r\n          </svg>\r\n        </Button>\r\n        <span class=\"zoom-level\">{{ Math.round(zoom * 100) }}%</span>\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"sm\"\r\n          @click=\"handleZoomIn\"\r\n          :disabled=\"zoom >= 2\"\r\n          aria-label=\"Zoom in\"\r\n        >\r\n          <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m3-3H7\" />\r\n          </svg>\r\n        </Button>\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"sm\"\r\n          @click=\"handleResetZoom\"\r\n          aria-label=\"Reset zoom\"\r\n        >\r\n          Reset\r\n        </Button>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Main Layout -->\r\n    <div class=\"workflow-designer__layout\">\r\n      <!-- Canvas Area -->\r\n      <div class=\"workflow-designer__canvas-area\">\r\n        <WorkflowCanvas\r\n          :nodes=\"workflowFormData.nodes\"\r\n          :transitions=\"workflowFormData.transitions\"\r\n          :zoom=\"zoom\"\r\n          :pan=\"pan\"\r\n          :selected-node-id=\"selectedNodeId\"\r\n          :selected-transition-id=\"selectedTransitionId\"\r\n          :show-grid=\"showGrid\"\r\n          @node-click=\"handleNodeClick\"\r\n          @transition-click=\"handleTransitionClick\"\r\n          @node-drag=\"handleNodeDrag\"\r\n          @pan-change=\"handlePanChange\"\r\n          @zoom-change=\"handleZoomChange\"\r\n        />\r\n      </div>\r\n\r\n      <!-- Right Panel: Node/Transition Editor -->\r\n      <div class=\"workflow-designer__properties\">\r\n        <NodeEditor\r\n          v-if=\"selectedNode\"\r\n          :node=\"selectedNode\"\r\n          :workflow-nodes=\"workflowFormData.nodes\"\r\n          @save=\"handleSaveNode\"\r\n          @delete=\"handleDeleteNode\"\r\n          @cancel=\"selectedNode = null\"\r\n        />\r\n        <TransitionEditor\r\n          v-else-if=\"selectedTransition\"\r\n          :transition=\"selectedTransition\"\r\n          :workflow-nodes=\"workflowFormData.nodes\"\r\n          @save=\"handleSaveTransition\"\r\n          @delete=\"handleDeleteTransition\"\r\n          @cancel=\"selectedTransition = null\"\r\n        />\r\n        <div v-else class=\"properties-empty\">\r\n          <p>Select a node or transition to edit</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Node Creation Menu -->\r\n    <div\r\n      v-if=\"showNodeMenu\"\r\n      class=\"node-menu\"\r\n      :style=\"nodeMenuStyle\"\r\n      @click.stop\r\n    >\r\n      <Button\r\n        variant=\"ghost\"\r\n        size=\"sm\"\r\n        @click=\"handleAddNode('start')\"\r\n        :disabled=\"hasStartNode\"\r\n      >\r\n        Add Start Node\r\n      </Button>\r\n      <Button variant=\"ghost\" size=\"sm\" @click=\"handleAddNode('state')\">\r\n        Add State Node\r\n      </Button>\r\n      <Button variant=\"ghost\" size=\"sm\" @click=\"handleAddNode('end')\">\r\n        Add End Node\r\n      </Button>\r\n    </div>\r\n\r\n    <!-- Modals -->\r\n    <DeleteConfirmModal\r\n      v-if=\"deletingWorkflow\"\r\n      :title=\"`Delete Workflow: ${deletingWorkflow.name}`\"\r\n      :message=\"'This action cannot be undone. Are you sure?'\"\r\n      @confirm=\"confirmDeleteWorkflow\"\r\n      @cancel=\"deletingWorkflow = null\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, reactive, computed, onMounted } from 'vue'\r\nimport { useRouter } from 'vue-router'\r\nimport { useAuthStore } from '@/stores/authStore'\r\nimport { useAdminStore } from '@/stores/adminStore'\r\nimport { useNotificationStore } from '@/stores/notificationStore'\r\nimport type {\r\n  Workflow,\r\n  WorkflowNode,\r\n  WorkflowTransition,\r\n  CreateWorkflowRequest,\r\n  UpdateWorkflowRequest\r\n} from '@/types/admin'\r\nimport Button from '@/components/Common/Button.vue'\r\nimport Input from '@/components/Common/Input.vue'\r\nimport WorkflowCanvas from '@/components/admin/WorkflowCanvas.vue'\r\nimport NodeEditor from '@/components/admin/NodeEditor.vue'\r\nimport TransitionEditor from '@/components/admin/TransitionEditor.vue'\r\nimport DeleteConfirmModal from '@/components/admin/DeleteConfirmModal.vue'\r\n\r\n// Hooks\r\nconst router = useRouter()\r\nconst authStore = useAuthStore()\r\nconst adminStore = useAdminStore()\r\nconst notificationStore = useNotificationStore()\r\n\r\n// State\r\nconst currentWorkflow = ref<Workflow | null>(null)\r\nconst selectedNode = ref<WorkflowNode | null>(null)\r\nconst selectedNodeId = ref<string | null>(null)\r\nconst selectedTransition = ref<WorkflowTransition | null>(null)\r\nconst selectedTransitionId = ref<string | null>(null)\r\nconst deletingWorkflow = ref<Workflow | null>(null)\r\nconst isSavingWorkflow = ref(false)\r\nconst zoom = ref(1)\r\nconst pan = ref({ x: 0, y: 0 })\r\nconst showGrid = ref(true)\r\nconst showNodeMenu = ref(false)\r\nconst nodeMenuPosition = ref({ x: 0, y: 0 })\r\n\r\nconst workflowFormData = reactive<{\r\n  name: string\r\n  description: string\r\n  nodes: WorkflowNode[]\r\n  transitions: WorkflowTransition[]\r\n}>({\r\n  name: '',\r\n  description: '',\r\n  nodes: [],\r\n  transitions: []\r\n})\r\n\r\n// Computed\r\nconst canCreateWorkflow = computed(() =>\r\n  authStore.hasPermission.value('admin.workflow_manage')\r\n)\r\nconst canDeleteWorkflow = computed(() =>\r\n  authStore.hasPermission.value('admin.workflow_manage')\r\n)\r\n\r\nconst hasStartNode = computed(() => {\r\n  return workflowFormData.nodes.some((n) => n.type === 'start')\r\n})\r\n\r\nconst hasWorkflowChanges = computed(() => {\r\n  if (!currentWorkflow.value) return false\r\n  return (\r\n    workflowFormData.name !== currentWorkflow.value.name ||\r\n    workflowFormData.description !== (currentWorkflow.value.description || '') ||\r\n    JSON.stringify(workflowFormData.nodes) !==\r\n      JSON.stringify(currentWorkflow.value.nodes) ||\r\n    JSON.stringify(workflowFormData.transitions) !==\r\n      JSON.stringify(currentWorkflow.value.transitions)\r\n  )\r\n})\r\n\r\nconst nodeMenuStyle = computed(() => {\r\n  return {\r\n    left: `${nodeMenuPosition.value.x}px`,\r\n    top: `${nodeMenuPosition.value.y}px`\r\n  }\r\n})\r\n\r\n// Methods\r\nconst fetchWorkflows = async (): Promise<void> => {\r\n  try {\r\n    await adminStore.fetchWorkflows()\r\n  } catch (error) {\r\n    notificationStore.addNotification({\r\n      type: 'error',\r\n      title: 'Error',\r\n      message: 'Failed to load workflows'\r\n    })\r\n  }\r\n}\r\n\r\nconst handleCreateWorkflow = (): void => {\r\n  currentWorkflow.value = null\r\n  workflowFormData.name = 'New Workflow'\r\n  workflowFormData.description = ''\r\n  workflowFormData.nodes = []\r\n  workflowFormData.transitions = []\r\n  selectedNode.value = null\r\n  selectedNodeId.value = null\r\n  selectedTransition.value = null\r\n  selectedTransitionId.value = null\r\n}\r\n\r\nconst handleSaveWorkflow = async (): Promise<void> => {\r\n  if (!workflowFormData.name.trim()) {\r\n    notificationStore.addNotification({\r\n      type: 'warning',\r\n      title: 'Warning',\r\n      message: 'Workflow name is required'\r\n    })\r\n    return\r\n  }\r\n\r\n  // Validate workflow\r\n  if (workflowFormData.nodes.length === 0) {\r\n    notificationStore.addNotification({\r\n      type: 'warning',\r\n      title: 'Warning',\r\n      message: 'Workflow must have at least one node'\r\n    })\r\n    return\r\n  }\r\n\r\n  if (!hasStartNode.value) {\r\n    notificationStore.addNotification({\r\n      type: 'warning',\r\n      title: 'Warning',\r\n      message: 'Workflow must have at least one start node'\r\n    })\r\n    return\r\n  }\r\n\r\n  const hasEndNode = workflowFormData.nodes.some((n) => n.type === 'end')\r\n  if (!hasEndNode) {\r\n    notificationStore.addNotification({\r\n      type: 'warning',\r\n      title: 'Warning',\r\n      message: 'Workflow must have at least one end node'\r\n    })\r\n    return\r\n  }\r\n\r\n  isSavingWorkflow.value = true\r\n  try {\r\n    if (currentWorkflow.value) {\r\n      // Update existing\r\n      const updateData: UpdateWorkflowRequest = {\r\n        name: workflowFormData.name,\r\n        description: workflowFormData.description || undefined,\r\n        nodes: workflowFormData.nodes,\r\n        transitions: workflowFormData.transitions\r\n      }\r\n      await adminStore.updateWorkflow(currentWorkflow.value.id, updateData)\r\n      notificationStore.addNotification({\r\n        type: 'success',\r\n        title: 'Success',\r\n        message: 'Workflow updated successfully'\r\n      })\r\n    } else {\r\n      // Create new\r\n      const createData: CreateWorkflowRequest = {\r\n        name: workflowFormData.name,\r\n        description: workflowFormData.description || undefined,\r\n        nodes: workflowFormData.nodes,\r\n        transitions: workflowFormData.transitions,\r\n        is_active: false\r\n      }\r\n      const newWorkflow = await adminStore.createWorkflow(createData)\r\n      currentWorkflow.value = newWorkflow\r\n      notificationStore.addNotification({\r\n        type: 'success',\r\n        title: 'Success',\r\n        message: 'Workflow created successfully'\r\n      })\r\n    }\r\n    await fetchWorkflows()\r\n  } catch (error) {\r\n    notificationStore.addNotification({\r\n      type: 'error',\r\n      title: 'Error',\r\n      message: 'Failed to save workflow'\r\n    })\r\n  } finally {\r\n    isSavingWorkflow.value = false\r\n  }\r\n}\r\n\r\nconst handleDeleteWorkflow = (): void => {\r\n  if (currentWorkflow.value) {\r\n    deletingWorkflow.value = currentWorkflow.value\r\n  }\r\n}\r\n\r\nconst confirmDeleteWorkflow = async (): Promise<void> => {\r\n  if (!deletingWorkflow.value) return\r\n\r\n  try {\r\n    await adminStore.deleteWorkflow(deletingWorkflow.value.id)\r\n    deletingWorkflow.value = null\r\n    currentWorkflow.value = null\r\n    notificationStore.addNotification({\r\n      type: 'success',\r\n      title: 'Success',\r\n      message: 'Workflow deleted successfully'\r\n    })\r\n    await fetchWorkflows()\r\n  } catch (error) {\r\n    notificationStore.addNotification({\r\n      type: 'error',\r\n      title: 'Error',\r\n      message: 'Failed to delete workflow'\r\n    })\r\n  }\r\n}\r\n\r\nconst handleNodeClick = (node: WorkflowNode): void => {\r\n  selectedNode.value = node\r\n  selectedNodeId.value = node.id\r\n  selectedTransition.value = null\r\n  selectedTransitionId.value = null\r\n}\r\n\r\nconst handleTransitionClick = (transition: WorkflowTransition): void => {\r\n  selectedTransition.value = transition\r\n  selectedTransitionId.value = transition.id\r\n  selectedNode.value = null\r\n  selectedNodeId.value = null\r\n}\r\n\r\nconst handleNodeDrag = (\r\n  nodeId: string,\r\n  position: { x: number; y: number }\r\n): void => {\r\n  const node = workflowFormData.nodes.find((n) => n.id === nodeId)\r\n  if (node) {\r\n    node.position = { ...position }\r\n  }\r\n}\r\n\r\nconst handlePanChange = (newPan: { x: number; y: number }): void => {\r\n  pan.value = { ...newPan }\r\n}\r\n\r\nconst handleZoomChange = (newZoom: number): void => {\r\n  zoom.value = newZoom\r\n}\r\n\r\nconst handleZoomIn = (): void => {\r\n  zoom.value = Math.min(2, zoom.value + 0.1)\r\n}\r\n\r\nconst handleZoomOut = (): void => {\r\n  zoom.value = Math.max(0.5, zoom.value - 0.1)\r\n}\r\n\r\nconst handleResetZoom = (): void => {\r\n  zoom.value = 1\r\n  pan.value = { x: 0, y: 0 }\r\n}\r\n\r\nconst handleAddNode = (type: 'start' | 'state' | 'end'): void => {\r\n  if (type === 'start' && hasStartNode.value) {\r\n    notificationStore.addNotification({\r\n      type: 'warning',\r\n      title: 'Warning',\r\n      message: 'Workflow can only have one start node'\r\n    })\r\n    return\r\n  }\r\n\r\n  const newNode: WorkflowNode = {\r\n    id: `node-${Date.now()}`,\r\n    name: type === 'start' ? 'Start' : type === 'end' ? 'End' : 'New State',\r\n    type,\r\n    position: {\r\n      x: nodeMenuPosition.value.x / zoom.value - pan.value.x / zoom.value,\r\n      y: nodeMenuPosition.value.y / zoom.value - pan.value.y / zoom.value\r\n    },\r\n    allowed_roles: [],\r\n    actions: []\r\n  }\r\n\r\n  workflowFormData.nodes.push(newNode)\r\n  showNodeMenu.value = false\r\n  selectedNode.value = newNode\r\n  selectedNodeId.value = newNode.id\r\n}\r\n\r\nconst handleSaveNode = (node: WorkflowNode): void => {\r\n  const index = workflowFormData.nodes.findIndex((n) => n.id === node.id)\r\n  if (index !== -1) {\r\n    workflowFormData.nodes[index] = { ...node }\r\n  }\r\n  selectedNode.value = null\r\n  selectedNodeId.value = null\r\n}\r\n\r\nconst handleDeleteNode = (nodeId: string): void => {\r\n  // Remove node\r\n  workflowFormData.nodes = workflowFormData.nodes.filter((n) => n.id !== nodeId)\r\n  // Remove related transitions\r\n  workflowFormData.transitions = workflowFormData.transitions.filter(\r\n    (t) => t.from_node !== nodeId && t.to_node !== nodeId\r\n  )\r\n  selectedNode.value = null\r\n  selectedNodeId.value = null\r\n}\r\n\r\nconst handleSaveTransition = (transition: WorkflowTransition): void => {\r\n  const index = workflowFormData.transitions.findIndex((t) => t.id === transition.id)\r\n  if (index !== -1) {\r\n    workflowFormData.transitions[index] = { ...transition }\r\n  } else {\r\n    workflowFormData.transitions.push(transition)\r\n  }\r\n  selectedTransition.value = null\r\n  selectedTransitionId.value = null\r\n}\r\n\r\nconst handleDeleteTransition = (transitionId: string): void => {\r\n  workflowFormData.transitions = workflowFormData.transitions.filter(\r\n    (t) => t.id !== transitionId\r\n  )\r\n  selectedTransition.value = null\r\n  selectedTransitionId.value = null\r\n}\r\n\r\n// Lifecycle\r\nonMounted(async () => {\r\n  if (!authStore.hasPermission.value('admin.workflow_manage')) {\r\n    await router.push({ name: 'forbidden' })\r\n    return\r\n  }\r\n\r\n  await fetchWorkflows()\r\n\r\n  // Handle canvas right-click for node menu\r\n  document.addEventListener('contextmenu', (e) => {\r\n    if ((e.target as HTMLElement).closest('.workflow-designer__canvas-area')) {\r\n      e.preventDefault()\r\n      nodeMenuPosition.value = { x: e.clientX, y: e.clientY }\r\n      showNodeMenu.value = true\r\n    } else {\r\n      showNodeMenu.value = false\r\n    }\r\n  })\r\n\r\n  document.addEventListener('click', () => {\r\n    showNodeMenu.value = false\r\n  })\r\n})\r\n</script>\r\n\r\n<style scoped lang=\"css\">\r\n.workflow-designer {\r\n  display: flex;\r\n  flex-direction: column;\r\n  height: 100%;\r\n  padding: 24px;\r\n  gap: 16px;\r\n}\r\n\r\n.workflow-designer__toolbar {\r\n  display: flex;\r\n  gap: 12px;\r\n  align-items: center;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.workflow-designer__workflow-info {\r\n  display: flex;\r\n  gap: 8px;\r\n  align-items: center;\r\n  flex: 1;\r\n}\r\n\r\n.workflow-name-input {\r\n  flex: 1;\r\n  max-width: 300px;\r\n}\r\n\r\n.workflow-designer__zoom-controls {\r\n  display: flex;\r\n  gap: 8px;\r\n  align-items: center;\r\n  margin-left: auto;\r\n}\r\n\r\n.zoom-level {\r\n  font-size: var(--font-size-sm, 12px);\r\n  color: var(--color-text-secondary, #6b7280);\r\n  min-width: 50px;\r\n  text-align: center;\r\n}\r\n\r\n.workflow-designer__layout {\r\n  display: grid;\r\n  grid-template-columns: 1fr 350px;\r\n  gap: 24px;\r\n  flex: 1;\r\n  min-height: 0;\r\n}\r\n\r\n.workflow-designer__canvas-area {\r\n  background: var(--color-surface, #ffffff);\r\n  border: 1px solid var(--color-border, #e5e7eb);\r\n  border-radius: var(--radius-lg, 8px);\r\n  overflow: hidden;\r\n  position: relative;\r\n}\r\n\r\n.workflow-designer__properties {\r\n  background: var(--color-surface, #ffffff);\r\n  border: 1px solid var(--color-border, #e5e7eb);\r\n  border-radius: var(--radius-lg, 8px);\r\n  overflow-y: auto;\r\n}\r\n\r\n.properties-empty {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  height: 100%;\r\n  color: var(--color-text-secondary, #6b7280);\r\n  padding: 48px 24px;\r\n  text-align: center;\r\n}\r\n\r\n.node-menu {\r\n  position: fixed;\r\n  background: var(--color-surface, #ffffff);\r\n  border: 1px solid var(--color-border, #e5e7eb);\r\n  border-radius: var(--radius-base, 6px);\r\n  box-shadow: var(--shadow-lg, 0 10px 15px rgba(0, 0, 0, 0.1));\r\n  padding: 8px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 4px;\r\n  z-index: 1000;\r\n}\r\n\r\n/* Responsive */\r\n@media (max-width: 968px) {\r\n  .workflow-designer__layout {\r\n    grid-template-columns: 1fr;\r\n    grid-template-rows: 1fr auto;\r\n  }\r\n\r\n  .workflow-designer__properties {\r\n    max-height: 400px;\r\n  }\r\n}\r\n</style>\r\n\r\n\r\n\r\n"],"names":["props","__props","emit","__emit","canvasRef","ref","canvasWidth","canvasHeight","isPanning","panStart","x","y","isDragging","dragNodeId","dragStart","canvasStyle","computed","transform","pan","zoom","transformOrigin","getNodeStyle","node","left","position","top","getTransitionPath","transition","fromNode","nodes","find","n","id","from_node","toNode","to_node","fromX","fromY","toX","toY","dx","getTransitionLabelX","getTransitionLabelY","handleWheel","event","delta","deltaY","newZoom","Math","max","min","handleMouseDown","button","ctrlKey","value","clientX","clientY","preventDefault","handleMouseMove","rect","_a","getBoundingClientRect","handleMouseUp","handleMouseLeave","handleNodeDragEnd","onMounted","offsetWidth","offsetHeight","onUnmounted","_createElementBlock","class","style","onWheel","onMousedown","onMousemove","onMouseup","onMouseleave","showGrid","width","height","_createElementVNode","patternUnits","d","fill","stroke","_Fragment","_renderList","key","_normalizeClass","type","selectedNodeId","_normalizeStyle","_withModifiers","$event","handleNodeMouseDown","onClick","handleNodeClick","draggable","onDragstart","_cache","onDragend","role","tabindex","name","_hoisted_4","_hoisted_5","_openBlock","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_toDisplayString","description","_hoisted_10","markerWidth","markerHeight","refX","refY","orient","points","transitions","handleTransitionClick","label","_hoisted_14","isSaving","errors","reactive","formData","allowed_roles","actions","nodeTypeOptions","roleOptions","actionOptions","watch","newNode","immediate","handleSave","Object","keys","forEach","trim","length","updatedNode","__spreadProps","__spreadValues","handleDelete","confirm","_hoisted_1","_hoisted_2","_createVNode","Button","variant","size","$emit","viewBox","onSubmit","_hoisted_3","Input","modelValue","required","error","Select","options","disabled","rows","placeholder","_vModelText","checked","includes","onChange","target","push","filter","r","handleRoleChange","action","some","a","action_type","actionType","Date","now","target_node_id","handleActionChange","_hoisted_12","loading","condition","conditionType","conditionRole","conditionAction","conditionDays","fromNodeName","workflowNodes","toNodeName","conditionTypeOptions","newTransition","cond","field","String","Number","handleConditionTypeChange","operator","updatedTransition","readonly","_hoisted_11","number","router","useRouter","authStore","useAuthStore","adminStore","useAdminStore","notificationStore","useNotificationStore","currentWorkflow","selectedNode","selectedTransition","selectedTransitionId","deletingWorkflow","isSavingWorkflow","showNodeMenu","nodeMenuPosition","workflowFormData","canCreateWorkflow","hasPermission","canDeleteWorkflow","hasStartNode","hasWorkflowChanges","JSON","stringify","nodeMenuStyle","fetchWorkflows","__async","this","addNotification","title","message","handleCreateWorkflow","handleSaveWorkflow","updateData","updateWorkflow","createData","is_active","newWorkflow","createWorkflow","handleDeleteWorkflow","confirmDeleteWorkflow","deleteWorkflow","handleNodeDrag","nodeId","handlePanChange","newPan","handleZoomChange","handleZoomIn","handleZoomOut","handleResetZoom","handleAddNode","handleSaveNode","index","findIndex","handleDeleteNode","t","handleSaveTransition","handleDeleteTransition","transitionId","document","addEventListener","e","closest","_createBlock","round","WorkflowCanvas","onNodeClick","onTransitionClick","onNodeDrag","onPanChange","onZoomChange","NodeEditor","onSave","onDelete","onCancel","TransitionEditor","DeleteConfirmModal","onConfirm"],"mappings":"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"}