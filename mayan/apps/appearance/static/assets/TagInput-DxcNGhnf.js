var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l;import{b as r,r as o,c as s,e as i,j as u,f as c,i as d,n as p,k as v,a as f,p as b,q as g,C as m,l as h,s as w,A as k,t as y,u as x,m as j,F as C,h as _,v as M,T as z}from"./vue-vendor-FOQ7SlVG.js";import{_ as B}from"./Badge.vue_vue_type_script_setup_true_lang-DSCw0GKm.js";import{j as L,b as I,d as $}from"./index-Bkz-5-QE.js";import{o as V}from"./utils-vendor-C6ZCcsv1.js";const O=["srcset"],U=["src","alt","loading"],R=r({__name:"OptimizedImage",props:{src:{},alt:{},loading:{default:"lazy"},webpUrl:{default:void 0},class:{}},setup(e){const t=e,a=o(!1),l=o(!1),n=s(()=>[t.class,l.value?"opacity-100":"opacity-0","transition-opacity duration-300"].filter(Boolean).join(" "));function r(){a.value=!0}function v(){l.value=!0}const f=s(()=>{if(t.webpUrl)return t.webpUrl;if(t.src&&!a.value){const e=new URL(t.src,window.location.origin),a=e.pathname,l=a.replace(/\.(jpg|jpeg|png)$/i,".webp");return l!==a?`${e.origin}${l}`:void 0}});return(t,a)=>(u(),i("picture",null,[f.value?(u(),i("source",{key:0,srcset:f.value,type:"image/webp"},null,8,O)):c("",!0),d("img",{src:e.src,alt:e.alt,loading:e.loading,class:p(n.value),onError:r,onLoad:v},null,42,U)]))}});function S(e,r){const s=o(!1),i=o(!1);let u=null;const c=((e,r)=>{for(var o in r||(r={}))a.call(r,o)&&n(e,o,r[o]);if(t)for(var o of t(r))l.call(r,o)&&n(e,o,r[o]);return e})({root:null,rootMargin:"50px",threshold:.1},r);return v(()=>{e.value&&(u=new IntersectionObserver(e=>{e.forEach(e=>{s.value=e.isIntersecting,e.isIntersecting&&!i.value&&(i.value=!0)})},c),u.observe(e.value))}),f(()=>{u&&e.value&&(u.unobserve(e.value),u.disconnect())}),{isIntersecting:s,hasIntersected:i}}const K=["aria-label","onKeydown"],T=["checked","aria-label"],A={key:1,class:"w-full h-full flex items-center justify-center"},E={key:2,class:"w-full h-full flex items-center justify-center bg-neutral-200 dark:bg-neutral-200"},P={key:4,class:"absolute top-2 right-2"},F={class:"p-3"},H={class:"text-sm font-medium text-neutral-900 dark:text-neutral-900 truncate mb-1"},q={class:"flex items-center justify-between text-xs text-neutral-600 dark:text-neutral-600"},D=r({__name:"AssetCard",props:{asset:{},isSelected:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!0}},emits:["select","open","preview","download","more"],setup(e,{emit:t}){const a=e,l=t,n=o(!1),r=o(null),{hasIntersected:v}=S(r,{rootMargin:"100px"}),f=s(()=>v.value||a.isLoading),j=s(()=>{if(a.asset.thumbnail_url)return function(e){if(e)try{const t=new URL(e,window.location.origin),a=t.pathname,l=a.replace(/\.(jpg|jpeg|png)$/i,".webp");if(l!==a)return`${t.origin}${l}${t.search}${t.hash}`}catch(t){return e.replace(/\.(jpg|jpeg|png)$/i,".webp")}}(a.asset.thumbnail_url)}),C=s(()=>["relative","bg-neutral-0","dark:bg-neutral-0","rounded-lg","border","border-neutral-300","dark:border-neutral-300","overflow-hidden","cursor-pointer","transition-all","duration-fast","hover:shadow-lg",a.isSelected?"ring-2 ring-primary-500":""].filter(Boolean).join(" "));function _(){l("select",a.asset)}function M(){l("open",a.asset)}function z(){l("select",a.asset)}function $(){l("preview",a.asset)}function V(){l("download",a.asset)}function O(){l("more",a.asset)}return(t,l)=>{var o,s;return u(),i("div",{class:p(C.value),role:"button",tabindex:"0","aria-label":`Актив: ${e.asset.label}`,onClick:_,onDblclick:M,onMouseenter:l[2]||(l[2]=e=>n.value=!0),onMouseleave:l[3]||(l[3]=e=>n.value=!1),onKeydown:[b(_,["enter"]),b(g(_,["prevent"]),["space"])]},[e.showCheckbox&&(n.value||e.isSelected)?(u(),i("div",{key:0,class:"absolute top-2 left-2 z-10",onClick:g(z,["stop"])},[d("input",{type:"checkbox",checked:e.isSelected,class:"w-5 h-5 rounded border-neutral-300 text-primary-500 focus:ring-primary-500 cursor-pointer min-w-[44px] min-h-[44px]",onClick:l[0]||(l[0]=g(()=>{},["stop"])),onChange:z,"aria-label":`Выбрать актив ${e.asset.label}`},null,40,T)])):c("",!0),d("div",{ref_key:"thumbnailRef",ref:r,class:"relative w-full h-48 bg-neutral-100 dark:bg-neutral-100 rounded-t-lg overflow-hidden"},[a.asset.thumbnail_url&&!a.isLoading&&f.value?(u(),m(R,{key:0,src:a.asset.thumbnail_url,alt:a.asset.label,loading:f.value?"lazy":"eager","webp-url":j.value,class:"w-full h-full object-cover"},null,8,["src","alt","loading","webp-url"])):e.isLoading?(u(),i("div",A,[...l[4]||(l[4]=[d("svg",{class:"animate-spin h-8 w-8 text-neutral-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[d("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),d("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):(u(),i("div",E,[...l[5]||(l[5]=[d("svg",{class:"w-12 h-12 text-neutral-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])])),n.value&&!e.isLoading?(u(),i("div",{key:3,class:"absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center gap-2 opacity-0 transition-opacity duration-fast hover:opacity-100",onClick:l[1]||(l[1]=g(()=>{},["stop"]))},[d("button",{class:"p-2 bg-white rounded-full hover:bg-neutral-100 transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center",onClick:g($,["stop"]),"aria-label":"Предпросмотр актива",type:"button"},[...l[6]||(l[6]=[d("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])]),d("button",{class:"p-2 bg-white rounded-full hover:bg-neutral-100 transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center",onClick:g(V,["stop"]),"aria-label":"Скачать актив",type:"button"},[...l[7]||(l[7]=[d("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)])]),d("button",{class:"p-2 bg-white rounded-full hover:bg-neutral-100 transition-colors min-w-[44px] min-h-[44px] flex items-center justify-center",onClick:g(O,["stop"]),"aria-label":"Дополнительные действия",type:"button"},[...l[8]||(l[8]=[d("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})],-1)])])])):c("",!0),(null==(o=e.asset.metadata)?void 0:o.status)?(u(),i("div",P,[h(B,{variant:(s=e.asset.metadata.status,{approved:"success",pending:"warning",rejected:"error",draft:"neutral"}[s.toLowerCase()]||"neutral"),size:"sm"},{default:w(()=>[k(y(e.asset.metadata.status),1)]),_:1},8,["variant"])])):c("",!0)],512),d("div",F,[d("h3",H,y(e.asset.label),1),d("div",q,[d("span",null,y(x(L)(e.asset.size)),1),d("span",null,y(x(I)(e.asset.date_added)),1)])])],42,K)}}}),G=["onClick"],J=["placeholder","onKeydown"],N={key:0,class:"absolute z-50 mt-1 w-full bg-neutral-0 dark:bg-neutral-0 border border-neutral-300 dark:border-neutral-300 rounded-md shadow-lg max-h-60 overflow-y-auto"},Q=["onMousedown","onMouseenter"],W=$(r({__name:"TagInput",props:{modelValue:{},suggestions:{default:()=>[]},placeholder:{default:"Введите тег..."},allowCustom:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,l=t,n=o(null),r=o(null),v=o(""),f=o(!1),x=o(-1),L=s(()=>a.modelValue||[]),I=s(()=>{if(!v.value)return a.suggestions.filter(e=>!L.value.includes(e)).slice(0,10);const e=v.value.toLowerCase();return a.suggestions.filter(t=>t.toLowerCase().includes(e)&&!L.value.includes(t)).slice(0,10)});function $(){f.value=!0,x.value=-1}function O(){x.value>=0&&x.value<I.value.length?T(I.value[x.value]):v.value.trim()&&a.allowCustom&&S(v.value.trim())}function U(e){!v.value&&L.value.length>0&&K(L.value[L.value.length-1])}function R(){setTimeout(()=>{f.value=!1},200)}function S(e){if(e&&!L.value.includes(e)){const t=[...L.value,e];l("update:modelValue",t),v.value="",f.value=!1}}function K(e){const t=L.value.filter(t=>t!==e);l("update:modelValue",t)}function T(e){S(e)}return V(n,()=>{f.value=!1}),(t,a)=>(u(),i("div",{class:"tag-input",ref_key:"containerRef",ref:n},[d("div",{class:"flex flex-wrap gap-2 p-2 border border-neutral-300 dark:border-neutral-300 rounded-md bg-neutral-0 dark:bg-neutral-0 min-h-[42px] focus-within:ring-2 focus-within:ring-primary-500 focus-within:border-transparent",onClick:a[2]||(a[2]=e=>{var t;return null==(t=r.value)?void 0:t.focus()})},[(u(!0),i(C,null,_(L.value,e=>(u(),m(B,{key:e,variant:"info",size:"sm",class:"flex items-center gap-1"},{default:w(()=>[k(y(e)+" ",1),d("button",{class:"ml-1 hover:text-error transition-colors",onClick:g(t=>K(e),["stop"]),"aria-label":"Удалить тег"},[...a[3]||(a[3]=[d("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,G)]),_:2},1024))),128)),j(d("input",{ref_key:"inputRef",ref:r,"onUpdate:modelValue":a[0]||(a[0]=e=>v.value=e),type:"text",placeholder:e.placeholder,class:"flex-1 min-w-[120px] outline-none bg-transparent text-sm text-neutral-900 dark:text-neutral-900",onInput:$,onKeydown:[b(g(O,["prevent"]),["enter"]),b(U,["backspace"])],onFocus:a[1]||(a[1]=e=>f.value=!0),onBlur:R},null,40,J),[[M,v.value]])]),h(z,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:w(()=>[f.value&&I.value.length>0?(u(),i("div",N,[(u(!0),i(C,null,_(I.value,(e,t)=>(u(),i("button",{key:e,class:p(["w-full text-left px-4 py-2 text-sm hover:bg-neutral-100 dark:hover:bg-neutral-100 transition-colors",t===x.value?"bg-primary-50 dark:bg-primary-50":""]),onMousedown:g(t=>T(e),["prevent"]),onMouseenter:e=>x.value=t},y(e),43,Q))),128))])):c("",!0)]),_:1})],512))}}),[["__scopeId","data-v-a0f4601b"]]);export{W as T,D as _};
//# sourceMappingURL=TagInput-DxcNGhnf.js.map
